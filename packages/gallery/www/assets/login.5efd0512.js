import{E as q}from"./EmptyLayout.17226d71.js";import{A as y}from"./AuthService.10b9bc61.js";import{u as M,r as m,R as u}from"./vendor.2a83d1c9.js";import{b as R,a as k}from"./_app.41131035.js";import{C as H,v as B,a as F}from"./index.b1c16674.js";import{G as x}from"./Grid.d12fda45.js";import{T as z}from"./TextField.bc1d9226.js";import{B as $}from"./Button.11e5af54.js";import"./capitalize.75c82fb0.js";import"./Paper.678a179e.js";import"./IconButton.5bf8eb2a.js";import"./Typography.a1510182.js";import"./Close.a6b828d0.js";import"./createSvgIcon.50054fae.js";import"./useControlled.91b72ab4.js";import"./Dialog.4b91e65c.js";import"./Modal.22c32aef.js";import"./Backdrop.311b8a3e.js";import"./DialogTitle.d9bbb4af.js";import"./InputLabel.ed2935ea.js";import"./List.0dd6030d.js";/*!
 * Utilities for Web Request RPC.
 *
 * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.
 */const I={ParseError:{message:"Parse error",code:-32700},InvalidRequest:{message:"Invalid Request",code:-32600},MethodNotFound:{message:"Method not found",code:-32601},InvalidParams:{message:"Invalid params",code:-32602},InternalError:{message:"Internal Error",code:-32603},ServerError:{message:"Server error",code:-32e3}};function f(i,e){if(e===void 0&&(e=window.location.href),typeof URL=="function")return new URL(i,e);if(typeof i!="string")throw new TypeError('"url" must be a string.');i.includes(":")||(e.startsWith("http")&&!i.startsWith("/")?i=e+"/"+i:i=e+i);const t=document.createElement("a");t.href=i;let n=(t.protocol||window.location.protocol)+"//";t.host?t.protocol==="http:"&&t.port==="80"||t.protocol==="https:"&&t.port==="443"?n+=t.hostname:n+=t.host:n+=window.location.host;let r=t.pathname;return r.startsWith("/")||(r="/"+r),{host:t.host||window.location.host,hostname:t.hostname,origin:n,protocol:t.protocol,pathname:r}}function V(i,e){for(e=i="";i++<36;e+=i*51&52?(i^15?8^Math.random()*(i^20?16:4):4).toString(16):"-");return e}function O(i){return i&&typeof i=="object"&&i.jsonrpc==="2.0"&&i.id&&typeof i.id=="string"}function G(i){return O(i)&&Array.isArray(i.params)}function K(i){return O(i)&&!!("result"in i^"error"in i)&&(!("error"in i)||Q(i.error))}function Q(i){return i&&typeof i=="object"&&typeof i.code=="number"&&typeof i.message=="string"}function X(i){const e={message:i.message};return i.constructor.name!=="Error"&&(e.constructor=i.constructor.name),"name"in i&&(e.name=i.name),"code"in i?e.code=i.code:e.code=I.ServerError.code,"details"in i&&(e.details=i.details),e}function Y(i){let e;return i.constructor==="DOMException"?e=new DOMException(i.message,i.name):(e=new Error(i.message),"code"in i&&(e.code=i.code)),i.details&&(e.details=i.details),e}function S({listener:i,origin:e,handle:t,expectRequest:n}){if(g(t)){const r=t;t=!1,r.then(s=>t=s)}return r=>{!(r.source===t&&r.origin===e&&(n&&G(r.data)||!n&&K(r.data)))||i(r.data,r)}}function J(i){let[e,...t]=i.split(".");const n=t.pop();return e=[e,...t].join("."),{name:e,method:n}}function g(i){try{return typeof i.then=="function"}catch(e){}return!1}/*!
 * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.
 */const Z=3e4;class A{constructor(){this.origin=null,this._handle=null,this._listener=null,this._pending=new Map}async connect(e,t){if(this._listener)throw new Error("Already connected.");t=t||{};const n=this;n.origin=f(e).origin,n._handle=t.handle||window.parent||window.opener;const r=n._pending;return n._listener=S({origin:n.origin,handle:n._handle,expectRequest:!1,listener:s=>{if(!r.has(s.id))return;const{resolve:l,reject:a,cancelTimeout:o}=r.get(s.id);if(o(),"result"in s)return l(s.result);a(Y(s.error))}}),window.addEventListener("message",n._listener),new ee(n)}async send(e,t,{timeout:n=Z}){if(!this._listener)throw new Error("RPC client not connected.");const r=this,s={jsonrpc:"2.0",id:V(),method:e,params:t};return g(r._handle)?(await r._handle).postMessage(s,r.origin):r._handle.postMessage(s,r.origin),new Promise((l,a)=>{const o=r._pending;let c;if(n>0){const d=setTimeout(()=>{o.delete(s.id),a(new Error("RPC call timed out."))},n);c=()=>{o.delete(s.id),clearTimeout(d)}}else c=()=>{o.delete(s.id)};o.set(s.id,{resolve:l,reject:a,cancelTimeout:c})})}close(){if(this._listener){window.removeEventListener("message",this._listener),this._handle=this.origin=this._listener=null;for(const e of this._pending.values())e.reject(new Error("RPC client closed."));this._pending=new Map}}}class ee{constructor(e){this.client=e,this._apis=new Map}define(e,t){if(!(e&&typeof e=="string"))throw new TypeError("`name` must be a non-empty string.");if(!(t&&typeof t=="object"&&Array.isArray(t.functions)))throw new TypeError("`definition.function` must be an array of function names or function definition objects to be defined.");const n=this,r={};return t.functions.forEach(s=>{typeof s=="string"&&(s={name:s,options:{}}),r[s.name]=async function(){return n.client.send(e+"."+s.name,[...arguments],s.options)}}),n._apis[e]=r,r}get(e,t){if(!this._apis[e]){if(t)return this.define(e,t);throw new Error(`API "${e}" has not been defined.`)}return this._apis[e]}}/*!
 * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.
 */class te{constructor({deserialize:e=n=>n,waitUntil:t=async()=>{}}={}){this._listeners=[],this._deserialize=e,this._waitUntil=t}async emit(e){return e=this._deserialize(e),(this._listeners[e.type]||[]).forEach(t=>t(e)),this._waitUntil(e)}addEventListener(e,t){this._listeners[e]?this._listeners[e].push(t):this._listeners[e]=[t]}removeEventListener(e,t){const n=this._listeners[e];if(!n)return;const r=n.indexOf(t);r!==-1&&n.splice(r,1)}}/*!
 * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.
 */class N{constructor(){this.origin=null,this._handle=null,this._apis=new Map}define(e,t){if(!(e&&typeof e=="string"))throw new TypeError("`name` must be a non-empty string.");if(!(t&&t!=="object"))throw new TypeError("`api` must be an object.");if(e in this._apis)throw new Error(`The "${e}" API is already defined.`);this._apis[e]=t}async listen(e,t){if(this._listener)throw new Error("Already listening.");t=t||{};const n=this;n.origin=f(e).origin,n._handle=t.handle||window.parent||window.opener;const r=t.ignoreUnknownApi==="true"||!1;n._listener=S({origin:n.origin,handle:n._handle,expectRequest:!0,listener:s=>{const{name:l,method:a}=J(s.method),o=n._apis[l];if(a&&a.startsWith("_"))return L(n._handle,n.origin,s);if(!o&&r)return;if(!o||typeof o[a]!="function")return L(n._handle,n.origin,s);const c=o[a];(async()=>{const d={jsonrpc:"2.0",id:s.id};try{d.result=await c.apply(o,s.params)}catch(h){d.error=X(h)}n._handle&&(g(n._handle)?n._handle.then(h=>h.postMessage(d,n.origin)):n._handle.postMessage(d,n.origin))})()}}),window.addEventListener("message",n._listener)}close(){this._listener&&(window.removeEventListener("message",this._listener),this._handle=this.origin=this._listener=null)}}function L(i,e,t){const n={jsonrpc:"2.0",id:t.id,error:Object.assign({},I.MethodNotFound)};return g(i)?i.then(r=>r.postMessage(n,e)):i.postMessage(n,e)}/*!
 * A WebApp is a remote application that runs in a WebAppContext.
 *
 * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.
 */class ie{constructor(e){this.relyingOrigin=f(e).origin,this.client=null,this.injector=null,this.client=new A,this.server=new N,this._control=null,this._connected=!1}async connect(){return this.injector=await this.client.connect(this.relyingOrigin),this._connected=!0,this._control=this.injector.define("core.control",{functions:["ready","show","hide"]}),this.server.listen(this.relyingOrigin),this.injector}async ready(){if(!this._connected)throw new Error('WebApp not connected. Did you call ".connect()"?');return await this._control.ready(),this}close(){this._connected&&(this.server.close(),this.client.close(),this._connected=!1)}async show(){if(!this._connected)throw new Error('Cannot "show" yet; not connected. Did you call ".connect()"?');return this._control.show()}async hide(){if(!this._connected)throw new Error('Cannot "hide" yet; not connected. Did you call ".connect()?"');return this._control.hide()}}/*!
 * Copyright (c) 2017-2018 Digital Bazaar, Inc. All rights reserved.
 */const ne=6e4;class E{constructor(e,{timeout:t=ne,handle:n,iframe:r,windowControl:s,className:l=null,customize:a=null}={}){if(this.visible=!1,this.dialog=null,this.iframe=null,this.handle=null,this.windowControl=null,this._ready=!1,this._private={},this._timeoutId=null,this._private._readyPromise=new Promise((c,d)=>{this._timeoutId=setTimeout(()=>d(new DOMException("Loading Web application window timed out.","TimeoutError")),t),this._private._resolveReady=h=>{clearTimeout(this.timeoutId),this._timeoutId=null,c(h)},this._private._rejectReady=h=>{clearTimeout(this.timeoutId),this._timeoutId=null,d(h)}}),this._private.isReady=async()=>this._private._readyPromise,this._private.destroy=()=>{this._timeoutId&&this._private._rejectReady(new DOMException("Web application window closed before ready.","AbortError")),this.dialog&&(this.dialog.parentNode.removeChild(this.dialog),this.dialog=null)},r){if(!(typeof r=="object"&&r.contentWindow))throw new TypeError("`options.iframe` must be an iframe element.");this.windowControl={handle:r.contentWindow,show(){r.style.visibility="visible"},hide(){r.style.visibility="hidden"}},this.iframe=r,this.handle=this.iframe.contentWindow;return}if(s){this.windowControl=s,this.handle=this.windowControl.handle;return}if(n){this.handle=n;return}if(a&&!typeof a==="function")throw new TypeError("`options.customize` must be a function.");this.dialog=document.createElement("dialog"),v(this.dialog,{position:"fixed",top:0,left:0,width:"100%",height:"100%","max-width":"100%","max-height":"100%",display:"none",margin:0,padding:0,border:"none",background:"transparent",color:"black","box-sizing":"border-box",overflow:"hidden","z-index":1e6}),this.dialog.className="web-app-window",typeof l=="string"&&(this.dialog.className=this.dialog.className+" "+l);const o=document.createElement("style");if(o.appendChild(document.createTextNode(`dialog.web-app-window::backdrop {
        background-color: transparent;
      }`)),this.container=document.createElement("div"),v(this.container,{position:"relative",width:"100%",height:"100%",margin:0,padding:0,display:"flex","flex-direction":"column"}),this.container.className="web-app-window-backdrop",this.iframe=document.createElement("iframe"),this.iframe.src=e,this.iframe.scrolling="auto",v(this.iframe,{position:"fixed",top:0,left:0,width:"100%",height:"100%",border:"none",background:"transparent",overflow:"hidden",margin:0,padding:0,"flex-grow":1}),this.dialog.appendChild(o),this.container.appendChild(this.iframe),this.dialog.appendChild(this.container),this.dialog.addEventListener("cancel",c=>{c.preventDefault(),this.hide()}),document.body.appendChild(this.dialog),this.handle=this.iframe.contentWindow,a)try{a({dialog:this.dialog,container:this.container,iframe:this.iframe,webAppWindow:this})}catch(c){console.error(c)}}ready(){this._ready=!0,this._private._resolveReady(!0)}show(){if(!this.visible){this.visible=!0;const e=document.querySelector("body");this._bodyOverflowStyle=e.style.overflow,e.style.overflow="hidden",this.dialog?(this.dialog.style.display="block",this.dialog.showModal&&this.dialog.showModal()):this.windowControl.show&&this.windowControl.show()}}hide(){if(this.visible){this.visible=!1;const e=document.querySelector("body");if(this._bodyOverflowStyle?e.style.overflow=this._bodyOverflowStyle:e.style.overflow="",this.dialog){if(this.dialog.style.display="none",this.dialog.close)try{this.dialog.close()}catch(t){console.error(t)}}else this.windowControl.hide&&this.windowControl.hide()}}}function v(i,e){for(const t in e)i.style[t]=e[t]}/*!
 * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.
 */const re=1e4;class se{constructor(){this.client=new A,this.server=new N,this.injector=null,this.control=null,this.loaded=!1,this.closed=!1}async createWindow(e,{timeout:t=re,iframe:n,handle:r,windowControl:s,className:l,customize:a}={}){if(this.loaded)throw new Error("AppContext already loaded.");this.loaded=!0,this.control=new E(e,{timeout:t,iframe:n,handle:r,windowControl:s,className:l,customize:a}),this.server.define("core.control",this.control);const o=f(e).origin;return this.server.listen(o,{handle:this.control.handle,ignoreUnknownApi:!0}),await this.control._private.isReady(),this.injector=await this.client.connect(o,{handle:this.control.handle}),this.injector}close(){this.closed||(this.closed=!0,this.control._private.destroy(),this.server.close(),this.client.close())}}/*!
 * A CredentialRequestEvent is emitted when a request has been made for
 * credentials.
 *
 * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.
 */class oe{constructor({credentialHandler:e,credentialRequestOrigin:t,credentialRequestOptions:n,hintKey:r}){this.type="credentialrequest",this._credentialHandler=e,this.credentialRequestOrigin=t,this.credentialRequestOptions=n,this.hintKey=r}async openWindow(e){await this._credentialHandler.show();const t=new E(e,{className:"credential-handler"});return t.ready(),t.show(),t.handle}respondWith(e){this._promise=e}}/*!
 * A CredentialStoreEvent is emitted when a request has been made to
 * store a credential.
 *
 * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.
 */class ae{constructor({credentialHandler:e,credentialRequestOrigin:t,credential:n,hintKey:r}){this.type="credentialstore",this._credentialHandler=e,this.credentialRequestOrigin=t,this.credential=n,this.hintKey=r}async openWindow(e){await this._credentialHandler.show();const t=new E(e);return t.ready(),t.show(),t.handle}respondWith(e){this._promise=e}}/*!
 * A CredentialHandlerService handles remote calls to a CredentialHandler.
 *
 * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.
 */class le{constructor(e){this._credentialHandler=e}async request(e){return await this._credentialHandler._emitter.emit(new oe(Object.assign({credentialHandler:this._credentialHandler},e)))}async store(e){return await this._credentialHandler._emitter.emit(new ae(Object.assign({credentialHandler:this._credentialHandler},e)))}}/*!
 * The core CredentialHandler class.
 *
 * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.
 */const P=["credentialrequest","credentialstore"];class ce extends ie{constructor(e){if(typeof e!="string")throw new TypeError('"mediatorOrigin" must be a string.');super(e);this._emitter=new te({async waitUntil(t){return t._promise||Promise.reject(new DOMException('No "credentialrequest" event handler found.',"NotFoundError"))}})}async connect(){const e=await super.connect();return this.server.define("credentialHandler",new le(this)),await this.ready(),e}addEventListener(e,t){if(!P.includes(e))throw new DOMException(`Unsupported event type "${e}"`,"NotSupportedError");return this._emitter.addEventListener(e,t)}removeEventListener(e,t){if(!P.includes(e))throw new DOMException(`Unsupported event type "${e}"`,"NotSupportedError");return this._emitter.removeEventListener(e,t)}}/*!
 * API for managing CredentialHints.
 *
 * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.
 */class de{constructor(e,t){const n=t.get("credentialHints",{functions:["delete","get","keys","has","set","clear"]});for(let r in n)r!=="set"&&(this[r]=n[r].bind(this,e));this._remoteSet=n.set.bind(this,e)}async set(e,t){t.icons=t.icons||[];const n=t.icons.map(r=>he(r.src).then(s=>{r.fetchedImage=s}));return await Promise.all(n),this._remoteSet(e,t)}}function he(i){return new Promise(e=>{const t=new Image;t.crossOrigin="Anonymous",t.onload=()=>{let n=document.createElement("canvas");const r=n.getContext("2d");n.height=t.height,n.width=t.width,r.drawImage(t,0,0);const s=n.toDataURL();e(s),n=null},t.onerror=()=>e(null),t.src=i})}/*!
 * A CredentialManager for a Web Credential Mediator.
 *
 * Copyright (c) 2017-2018 Digital Bazaar, Inc. All rights reserved.
 */class b{constructor(e,t){if(!(e&&typeof e=="string"))throw new TypeError('"url" must be a non-empty string.');this.hints=new de(e,t)}static async requestPermission(){return(await navigator.credentialsPolyfill.permissions.request({name:"credentialhandler"})).state}}/*!
 * A CredentialHandlerRegistration provides a CredentialManager to enable Web
 * apps to register Profiles that can be presented to websites.
 *
 * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.
 */class W{constructor(e,t){if(!(e&&typeof e=="string"))throw new TypeError('"url" must be a non-empty string.');this.credentialManager=new b(e,t)}}/*!
 * Provides an API for working with CredentialHandlerRegistrations.
 *
 * Copyright (c) 2017-2018 Digital Bazaar, Inc. All rights reserved.
 */class ue{constructor(e){this._init=(async()=>{this._injector=await e,this._remote=this._injector.get("credentialHandlers",{functions:["register","unregister","getRegistration","hasRegistration"]})})()}async register(e){return await this._init,e=await this._remote.register("credential",e),new W(e,this._injector)}async unregister(e){return await this._init,this._remote.unregister("credential",e)}async getRegistration(e){return await this._init,e=await this._remote.getRegistration("credential",e),e?new W(e,this._injector):null}async hasRegistration(e){return await this._init,await this._remote.hasRegistration("credential",e)}}/*!
 * A WebCredential is a Credential that can be retrieved from or stored by a
 * "credential handler" that runs in a third party Web application.
 *
 * Copyright (c) 2017-2021 Digital Bazaar, Inc. All rights reserved.
 */class w{constructor(e,t,{recommendedHandlerOrigins:n=[]}={}){if(typeof e!="string")throw new TypeError('"dataType" must be a string.');this.type="web",this.dataType=e,this.data=t,this.options={recommendedHandlerOrigins:n}}}/*!
 * Wrapper for native CredentialsContainer that uses remote Credential Mediator
 * for WebCredential-related operations.
 *
 * Copyright (c) 2017-2018 Digital Bazaar, Inc. All rights reserved.
 */const pe=0,me=0;class we{constructor(e){this._nativeCredentialsContainer={get:navigator.credentials&&navigator.credentials.get&&navigator.credentials.get.bind(navigator.credentials),store:navigator.credentials&&navigator.credentials.store&&navigator.credentials.store.bind(navigator.credentials)},this._init=(async()=>{this._remote=(await e).get("credentialsContainer",{functions:[{name:"get",options:{timeout:pe}},{name:"store",options:{timeout:me}}]})})()}async get(e={}){if(e.web){await this._init;const t=await this._remote.get(e);return t?new w(t.dataType,t.data):null}if(this._nativeCredentialsContainer.get)return this._nativeCredentialsContainer.get(e);throw new DOMException("Not implemented.","NotSupportedError")}async store(e){if(e instanceof w){await this._init;const t=await this._remote.store(e);return t?new w(t.dataType,t.data):null}if(this._nativeCredentialsContainer.store)return this._nativeCredentialsContainer.store(e);throw new DOMException("Not implemented.","NotSupportedError")}}/*!
 * Provides an API for working with permissions.
 *
 * Copyright (c) 2017-2018 Digital Bazaar, Inc. All rights reserved.
 */const fe=0;class ge{constructor(e){this._init=(async()=>{this._remote=(await e).get("permissionManager",{functions:["query",{name:"request",options:{timeout:fe}},"revoke"]})})()}async query(e){return await this._init,await this._remote.query(e)}async request(e){return await this._init,await this._remote.request(e)}async revoke(e){return await this._init,await this._remote.revoke(e)}}/*!
 * Credential Handler API Polyfill.
 *
 * Copyright (c) 2017-2021 Digital Bazaar, Inc. All rights reserved.
 */const D="https://authn.io/mediator?origin="+encodeURIComponent(window.location.origin);let C;async function _e(i=D){return C||(C=!0,ye(i))}async function ye(i=D){const t=new se().createWindow(i,{className:"credential-mediator",timeout:3e4}),n=document.createElement("style");n.appendChild(document.createTextNode(`dialog.web-app-window.credential-mediator > .web-app-window-backdrop {
      background-color: rgba(0, 0, 0, 0.25);
    }`)),document.body.appendChild(n);const r={};return r.permissions=new ge(t),r.CredentialHandlers=new ue(t),r.CredentialHandler=ce,r.CredentialManager=b,r.credentials=new we(t),r.WebCredential=w,navigator.credentialsPolyfill=r,"credentials"in navigator?(navigator.credentials.get=r.credentials.get.bind(r.credentials),navigator.credentials.store=r.credentials.store.bind(r.credentials)):navigator.credentials=r.credentials,window.CredentialManager=b,window.WebCredential=w,r}const Ee="_container_1na42_2",ve="_gridContainer_1na42_6",be="_emailField_1na42_14",Ce="_sendButton_1na42_29";var _={container:Ee,gridContainer:ve,emailField:be,sendButton:Ce};const je=i=>{const{t:e}=M(),t=R(),n=k().user,[r,s]=m.exports.useState(n?.name.value),[l,a]=m.exports.useState(""),[o,c]=m.exports.useState(!1);m.exports.useState(!1);let d="";const h=async()=>{try{const p=`${H.publicRuntimeConfig.mediatorServer}/mediator?origin=${encodeURIComponent(window.location.origin)}`;await _e(p),console.log("Ready to work with credentials!")}catch(p){console.error("Error loading polyfill:",p)}};m.exports.useEffect(()=>{h()},[]),m.exports.useEffect(()=>{n&&s(n.name.value)},[n.name.value]);const U=p=>a(p.target.value),j=()=>{if(l==="")return!1;if(B(l.trim()))d="email";else if(F(l.trim()))d="sms";else return c(!0),!1;return c(!1),!0},T=p=>{p.preventDefault(),!!j()&&(d==="email"?t(y.addConnectionByEmail(l,n?.id?.value)):d==="sms"&&t(y.addConnectionBySms(l,n?.id?.value)))};return u.createElement("div",{className:_.container},u.createElement(x,{container:!0,className:_.gridContainer},u.createElement(x,{item:!0},u.createElement("form",{onSubmit:T,style:{display:"grid"}},u.createElement(z,{className:_.emailField,size:"small",placeholder:"Email",variant:"outlined",onChange:U,onBlur:j,error:o,helperText:o?e("user:usermenu.profile.phoneEmailError"):null}),u.createElement($,{className:_.sendButton,onClick:T},"Send Magic Link")))))},Ve=i=>{const e=R(),{t}=M();return m.exports.useEffect(()=>{e(y.doLoginAuto(!0))},[]),u.createElement(q,{pageTitle:t("login.pageTitle")},u.createElement(je,null))};export{Ve as IndexPage,Ve as default};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9naW4uNWVmZDA1MTIuanMiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy93ZWItcmVxdWVzdC1ycGMvdXRpbHMuanMiLCIuLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvd2ViLXJlcXVlc3QtcnBjL0NsaWVudC5qcyIsIi4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy93ZWItcmVxdWVzdC1ycGMvRXZlbnRFbWl0dGVyLmpzIiwiLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL3dlYi1yZXF1ZXN0LXJwYy9TZXJ2ZXIuanMiLCIuLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvd2ViLXJlcXVlc3QtcnBjL1dlYkFwcC5qcyIsIi4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy93ZWItcmVxdWVzdC1ycGMvV2ViQXBwV2luZG93LmpzIiwiLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL3dlYi1yZXF1ZXN0LXJwYy9XZWJBcHBDb250ZXh0LmpzIiwiLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2NyZWRlbnRpYWwtaGFuZGxlci1wb2x5ZmlsbC9DcmVkZW50aWFsUmVxdWVzdEV2ZW50LmpzIiwiLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2NyZWRlbnRpYWwtaGFuZGxlci1wb2x5ZmlsbC9DcmVkZW50aWFsU3RvcmVFdmVudC5qcyIsIi4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy9jcmVkZW50aWFsLWhhbmRsZXItcG9seWZpbGwvQ3JlZGVudGlhbEhhbmRsZXJTZXJ2aWNlLmpzIiwiLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2NyZWRlbnRpYWwtaGFuZGxlci1wb2x5ZmlsbC9DcmVkZW50aWFsSGFuZGxlci5qcyIsIi4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy9jcmVkZW50aWFsLWhhbmRsZXItcG9seWZpbGwvQ3JlZGVudGlhbEhpbnRzLmpzIiwiLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2NyZWRlbnRpYWwtaGFuZGxlci1wb2x5ZmlsbC9DcmVkZW50aWFsTWFuYWdlci5qcyIsIi4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy9jcmVkZW50aWFsLWhhbmRsZXItcG9seWZpbGwvQ3JlZGVudGlhbEhhbmRsZXJSZWdpc3RyYXRpb24uanMiLCIuLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvY3JlZGVudGlhbC1oYW5kbGVyLXBvbHlmaWxsL0NyZWRlbnRpYWxIYW5kbGVycy5qcyIsIi4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy9jcmVkZW50aWFsLWhhbmRsZXItcG9seWZpbGwvV2ViQ3JlZGVudGlhbC5qcyIsIi4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy9jcmVkZW50aWFsLWhhbmRsZXItcG9seWZpbGwvQ3JlZGVudGlhbHNDb250YWluZXIuanMiLCIuLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvY3JlZGVudGlhbC1oYW5kbGVyLXBvbHlmaWxsL1Blcm1pc3Npb25NYW5hZ2VyLmpzIiwiLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2NyZWRlbnRpYWwtaGFuZGxlci1wb2x5ZmlsbC9pbmRleC5qcyIsIi4uLy4uL3NyYy9jb21wb25lbnRzL0FkbWluTG9naW4vaW5kZXgudHN4IiwiLi4vLi4vc3JjL3BhZ2VzL2xvZ2luLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAqIFV0aWxpdGllcyBmb3IgV2ViIFJlcXVlc3QgUlBDLlxuICpcbiAqIENvcHlyaWdodCAoYykgMjAxNyBEaWdpdGFsIEJhemFhciwgSW5jLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICovXG4vKiBnbG9iYWwgVVJMICovXG4ndXNlIHN0cmljdCc7XG5cbmV4cG9ydCBjb25zdCBSUENfRVJST1JTID0ge1xuICBQYXJzZUVycm9yOiB7XG4gICAgbWVzc2FnZTogJ1BhcnNlIGVycm9yJyxcbiAgICBjb2RlOiAtMzI3MDBcbiAgfSxcbiAgSW52YWxpZFJlcXVlc3Q6IHtcbiAgICBtZXNzYWdlOiAnSW52YWxpZCBSZXF1ZXN0JyxcbiAgICBjb2RlOiAtMzI2MDBcbiAgfSxcbiAgTWV0aG9kTm90Rm91bmQ6IHtcbiAgICBtZXNzYWdlOiAnTWV0aG9kIG5vdCBmb3VuZCcsXG4gICAgY29kZTogLTMyNjAxXG4gIH0sXG4gIEludmFsaWRQYXJhbXM6IHtcbiAgICBtZXNzYWdlOiAnSW52YWxpZCBwYXJhbXMnLFxuICAgIGNvZGU6IC0zMjYwMlxuICB9LFxuICBJbnRlcm5hbEVycm9yOiB7XG4gICAgbWVzc2FnZTogJ0ludGVybmFsIEVycm9yJyxcbiAgICBjb2RlOiAtMzI2MDNcbiAgfSxcbiAgU2VydmVyRXJyb3I6IHtcbiAgICBtZXNzYWdlOiAnU2VydmVyIGVycm9yJyxcbiAgICBjb2RlOiAtMzIwMDBcbiAgfVxufTtcblxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlVXJsKHVybCwgYmFzZSkge1xuICBpZihiYXNlID09PSB1bmRlZmluZWQpIHtcbiAgICBiYXNlID0gd2luZG93LmxvY2F0aW9uLmhyZWY7XG4gIH1cblxuICBpZih0eXBlb2YgVVJMID09PSAnZnVuY3Rpb24nKSB7XG4gICAgcmV0dXJuIG5ldyBVUkwodXJsLCBiYXNlKTtcbiAgfVxuXG4gIGlmKHR5cGVvZiB1cmwgIT09ICdzdHJpbmcnKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignXCJ1cmxcIiBtdXN0IGJlIGEgc3RyaW5nLicpO1xuICB9XG5cbiAgLy8gRklYTUU6IHJ1ZGltZW50YXJ5IHJlbGF0aXZlIFVSTCByZXNvbHV0aW9uXG4gIGlmKCF1cmwuaW5jbHVkZXMoJzonKSkge1xuICAgIGlmKGJhc2Uuc3RhcnRzV2l0aCgnaHR0cCcpICYmICF1cmwuc3RhcnRzV2l0aCgnLycpKSB7XG4gICAgICB1cmwgPSBiYXNlICsgJy8nICsgdXJsO1xuICAgIH0gZWxzZSB7XG4gICAgICB1cmwgPSBiYXNlICsgdXJsO1xuICAgIH1cbiAgfVxuXG4gIC8vIGBVUkxgIEFQSSBub3Qgc3VwcG9ydGVkLCB1c2UgRE9NIHRvIHBhcnNlIFVSTFxuICBjb25zdCBwYXJzZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gIHBhcnNlci5ocmVmID0gdXJsO1xuICBsZXQgb3JpZ2luID0gKHBhcnNlci5wcm90b2NvbCB8fCB3aW5kb3cubG9jYXRpb24ucHJvdG9jb2wpICsgJy8vJztcbiAgaWYocGFyc2VyLmhvc3QpIHtcbiAgICAvLyB1c2UgaG9zdG5hbWUgd2hlbiB1c2luZyBkZWZhdWx0IHBvcnRzXG4gICAgLy8gKElFIGFkZHMgYWx3YXlzIGFkZHMgcG9ydCB0byBgcGFyc2VyLmhvc3RgKVxuICAgIGlmKChwYXJzZXIucHJvdG9jb2wgPT09ICdodHRwOicgJiYgcGFyc2VyLnBvcnQgPT09ICc4MCcpIHx8XG4gICAgICAocGFyc2VyLnByb3RvY29sID09PSAnaHR0cHM6JyAmJiBwYXJzZXIucG9ydCA9PT0gJzQ0MycpKSB7XG4gICAgICBvcmlnaW4gKz0gcGFyc2VyLmhvc3RuYW1lO1xuICAgIH0gZWxzZSB7XG4gICAgICBvcmlnaW4gKz0gcGFyc2VyLmhvc3Q7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIG9yaWdpbiArPSB3aW5kb3cubG9jYXRpb24uaG9zdDtcbiAgfVxuXG4gIC8vIGVuc3VyZSBwYXRobmFtZSBiZWdpbnMgd2l0aCBgL2BcbiAgbGV0IHBhdGhuYW1lID0gcGFyc2VyLnBhdGhuYW1lO1xuICBpZighcGF0aG5hbWUuc3RhcnRzV2l0aCgnLycpKSB7XG4gICAgcGF0aG5hbWUgPSAnLycgKyBwYXRobmFtZTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgLy8gVE9ETzogaXMgdGhpcyBzYWZlIGZvciBnZW5lcmFsIHVzZSBvbiBldmVyeSBicm93c2VyIHRoYXQgZG9lc24ndFxuICAgIC8vICAgc3VwcG9ydCBXSEFUV0cgVVJMP1xuICAgIGhvc3Q6IHBhcnNlci5ob3N0IHx8IHdpbmRvdy5sb2NhdGlvbi5ob3N0LFxuICAgIGhvc3RuYW1lOiBwYXJzZXIuaG9zdG5hbWUsXG4gICAgb3JpZ2luOiBvcmlnaW4sXG4gICAgcHJvdG9jb2w6IHBhcnNlci5wcm90b2NvbCxcbiAgICBwYXRobmFtZTogcGF0aG5hbWVcbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG9yaWdpbk1hdGNoZXModXJsLCBvcmlnaW4pIHtcbiAgcmV0dXJuIHBhcnNlVXJsKHVybCwgb3JpZ2luKS5vcmlnaW4gPT09IG9yaWdpbjtcbn1cblxuLy8gaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vTGV2ZXJPbmUvMTMwODM2OFxuZXhwb3J0IGZ1bmN0aW9uIHV1aWR2NChhLGIpIHtcbiAgZm9yKGI9YT0nJzthKys8MzY7Yis9YSo1MSY1Mj8oYV4xNT84Xk1hdGgucmFuZG9tKCkqKGFeMjA/MTY6NCk6NCkudG9TdHJpbmcoMTYpOictJyk7cmV0dXJuIGI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1ZhbGlkT3JpZ2luKHVybCwgb3JpZ2luKSB7XG4gIGlmKCFvcmlnaW5NYXRjaGVzKHVybCwgb3JpZ2luKSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgIGBPcmlnaW4gbWlzbWF0Y2guIFVybCBcIiR7dXJsfVwiIGRvZXMgbm90IGhhdmUgYW4gb3JpZ2luIG9mIFwiJHtvcmlnaW59XCIuYCk7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzVmFsaWRNZXNzYWdlKG1lc3NhZ2UpIHtcbiAgcmV0dXJuIChcbiAgICBtZXNzYWdlICYmIHR5cGVvZiBtZXNzYWdlID09PSAnb2JqZWN0JyAmJlxuICAgIG1lc3NhZ2UuanNvbnJwYyA9PT0gJzIuMCcgJiZcbiAgICBtZXNzYWdlLmlkICYmIHR5cGVvZiBtZXNzYWdlLmlkID09PSAnc3RyaW5nJyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1ZhbGlkUmVxdWVzdChtZXNzYWdlKSB7XG4gIHJldHVybiBpc1ZhbGlkTWVzc2FnZShtZXNzYWdlKSAmJiBBcnJheS5pc0FycmF5KG1lc3NhZ2UucGFyYW1zKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzVmFsaWRSZXNwb25zZShtZXNzYWdlKSB7XG4gIHJldHVybiAoXG4gICAgaXNWYWxpZE1lc3NhZ2UobWVzc2FnZSkgJiZcbiAgICAhISgncmVzdWx0JyBpbiBtZXNzYWdlIF4gJ2Vycm9yJyBpbiBtZXNzYWdlKSAmJlxuICAgICghKCdlcnJvcicgaW4gbWVzc2FnZSkgfHwgaXNWYWxpZEVycm9yKG1lc3NhZ2UuZXJyb3IpKSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1ZhbGlkRXJyb3IoZXJyb3IpIHtcbiAgcmV0dXJuIChcbiAgICBlcnJvciAmJiB0eXBlb2YgZXJyb3IgPT09ICdvYmplY3QnICYmXG4gICAgdHlwZW9mIGVycm9yLmNvZGUgPT09ICdudW1iZXInICYmXG4gICAgdHlwZW9mIGVycm9yLm1lc3NhZ2UgPT09ICdzdHJpbmcnKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNlcmlhbGl6ZUVycm9yKGVycm9yKSB7XG4gIGNvbnN0IGVyciA9IHtcbiAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlXG4gIH07XG4gIGlmKGVycm9yLmNvbnN0cnVjdG9yLm5hbWUgIT09ICdFcnJvcicpIHtcbiAgICBlcnIuY29uc3RydWN0b3IgPSBlcnJvci5jb25zdHJ1Y3Rvci5uYW1lO1xuICB9XG4gIGlmKCduYW1lJyBpbiBlcnJvcikge1xuICAgIGVyci5uYW1lID0gZXJyb3IubmFtZTtcbiAgfVxuICBpZignY29kZScgaW4gZXJyb3IpIHtcbiAgICBlcnIuY29kZSA9IGVycm9yLmNvZGU7XG4gIH0gZWxzZSB7XG4gICAgZXJyLmNvZGUgPSBSUENfRVJST1JTLlNlcnZlckVycm9yLmNvZGU7XG4gIH1cbiAgaWYoJ2RldGFpbHMnIGluIGVycm9yKSB7XG4gICAgZXJyLmRldGFpbHMgPSBlcnJvci5kZXRhaWxzO1xuICB9XG4gIHJldHVybiBlcnI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZXNlcmlhbGl6ZUVycm9yKGVycm9yKSB7XG4gIGxldCBlcnI7XG4gIC8vIHNwZWNpYWwgY2FzZSBrbm93biB0eXBlcywgb3RoZXJ3aXNlIHVzZSBnZW5lcmljIEVycm9yXG4gIGlmKGVycm9yLmNvbnN0cnVjdG9yID09PSAnRE9NRXhjZXB0aW9uJykge1xuICAgIGVyciA9IG5ldyBET01FeGNlcHRpb24oZXJyb3IubWVzc2FnZSwgZXJyb3IubmFtZSlcbiAgICAvLyBpZ25vcmUgY29kZSwgbmFtZSB3aWxsIHNldCBpdFxuICB9IGVsc2Uge1xuICAgIGVyciA9IG5ldyBFcnJvcihlcnJvci5tZXNzYWdlKTtcbiAgICBpZignY29kZScgaW4gZXJyb3IpIHtcbiAgICAgIGVyci5jb2RlID0gZXJyb3IuY29kZTtcbiAgICB9XG4gIH1cbiAgaWYoZXJyb3IuZGV0YWlscykge1xuICAgIGVyci5kZXRhaWxzID0gZXJyb3IuZGV0YWlscztcbiAgfVxuICByZXR1cm4gZXJyO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlTWVzc2FnZUxpc3RlbmVyKFxuICB7bGlzdGVuZXIsIG9yaWdpbiwgaGFuZGxlLCBleHBlY3RSZXF1ZXN0fSkge1xuICAvLyBIQUNLOiB3ZSBjYW4ndCBqdXN0IGBQcm9taXNlLnJlc29sdmUoaGFuZGxlKWAgYmVjYXVzZSBDaHJvbWUgaGFzXG4gIC8vIGEgYnVnIHRoYXQgdGhyb3dzIGFuIGV4Y2VwdGlvbiBpZiB0aGUgaGFuZGxlIGlzIGNyb3NzIGRvbWFpblxuICBpZihpc0hhbmRsZVByb21pc2UoaGFuZGxlKSkge1xuICAgIGNvbnN0IHByb21pc2UgPSBoYW5kbGU7XG4gICAgaGFuZGxlID0gZmFsc2U7XG4gICAgcHJvbWlzZS50aGVuKGggPT4gaGFuZGxlID0gaCk7XG4gIH1cbiAgcmV0dXJuIGUgPT4ge1xuICAgIC8vIGlnbm9yZSBtZXNzYWdlcyBmcm9tIGEgbm9uLW1hdGNoaW5nIGhhbmRsZSBvciBvcmlnaW5cbiAgICAvLyBvciB0aGF0IGRvbid0IGZvbGxvdyB0aGUgcHJvdG9jb2xcbiAgICBpZighKGUuc291cmNlID09PSBoYW5kbGUgJiYgZS5vcmlnaW4gPT09IG9yaWdpbiAmJlxuICAgICAgKChleHBlY3RSZXF1ZXN0ICYmIGlzVmFsaWRSZXF1ZXN0KGUuZGF0YSkpIHx8XG4gICAgICAgICghZXhwZWN0UmVxdWVzdCAmJiBpc1ZhbGlkUmVzcG9uc2UoZS5kYXRhKSkpKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBsaXN0ZW5lcihlLmRhdGEsIGUpO1xuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGVzdHJ1Y3R1cmVNZXRob2ROYW1lKGZxTWV0aG9kTmFtZSkge1xuICAvLyBmdWxseS1xdWFsaWZpZWQgbWV0aG9kIG5hbWUgaXM6IGA8YXBpLW5hbWU+LjxtZXRob2QtbmFtZT5gXG4gIC8vIHdoZXJlIGA8YXBpLW5hbWU+YCBpcyBhbGwgYnV0IHRoZSBsYXN0IGRvdC1kZWxpbWl0ZWQgc2VnbWVudCBhbmRcbiAgLy8gYDxtZXRob2QtbmFtZT5gIGlzIHRoZSBsYXN0IGRvdC1kZWxpbWl0ZWQgc2VnbWVudFxuICBsZXQgW25hbWUsIC4uLnJlc3RdID0gZnFNZXRob2ROYW1lLnNwbGl0KCcuJyk7XG4gIGNvbnN0IG1ldGhvZCA9IHJlc3QucG9wKCk7XG4gIG5hbWUgPSBbbmFtZSwgLi4ucmVzdF0uam9pbignLicpO1xuICByZXR1cm4ge25hbWUsIG1ldGhvZH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0hhbmRsZVByb21pc2UoaGFuZGxlKSB7XG4gIHRyeSB7XG4gICAgLy8gSEFDSzogd2UgY2FuJ3QganVzdCBgUHJvbWlzZS5yZXNvbHZlKGhhbmRsZSlgIGJlY2F1c2UgQ2hyb21lIGhhc1xuICAgIC8vIGEgYnVnIHRoYXQgdGhyb3dzIGFuIGV4Y2VwdGlvbiBpZiB0aGUgaGFuZGxlIGlzIGNyb3NzIGRvbWFpblxuICAgIHJldHVybiB0eXBlb2YgaGFuZGxlLnRoZW4gPT09ICdmdW5jdGlvbic7XG4gIH0gY2F0Y2goZSkge31cbiAgcmV0dXJuIGZhbHNlO1xufVxuIiwiLyohXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTcgRGlnaXRhbCBCYXphYXIsIEluYy4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqL1xuJ3VzZSBzdHJpY3QnO1xuXG5pbXBvcnQgKiBhcyB1dGlscyBmcm9tICcuL3V0aWxzLmpzJztcblxuLy8gMzAgc2Vjb25kIGRlZmF1bHQgdGltZW91dFxuY29uc3QgUlBDX0NMSUVOVF9DQUxMX1RJTUVPVVQgPSAzMDAwMDtcblxuZXhwb3J0IGNsYXNzIENsaWVudCB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMub3JpZ2luID0gbnVsbDtcbiAgICB0aGlzLl9oYW5kbGUgPSBudWxsO1xuICAgIHRoaXMuX2xpc3RlbmVyID0gbnVsbDtcbiAgICAvLyBhbGwgcGVuZGluZyByZXF1ZXN0c1xuICAgIHRoaXMuX3BlbmRpbmcgPSBuZXcgTWFwKCk7XG4gIH1cblxuICAvKipcbiAgICogQ29ubmVjdHMgdG8gYSBXZWIgUmVxdWVzdCBSUEMgc2VydmVyLlxuICAgKlxuICAgKiBUaGUgUHJvbWlzZSB3aWxsIHJlc29sdmUgdG8gYW4gUlBDIGluamVjdG9yIHRoYXQgY2FuIGJlIHVzZWQgdG8gZ2V0IG9yXG4gICAqIGRlZmluZSBBUElzIHRvIGVuYWJsZSBjb21tdW5pY2F0aW9uIHdpdGggdGhlIHNlcnZlci5cbiAgICpcbiAgICogQHBhcmFtIG9yaWdpbiB0aGUgb3JpZ2luIHRvIHNlbmQgbWVzc2FnZXMgdG8uXG4gICAqIEBwYXJhbSBvcHRpb25zIHRoZSBvcHRpb25zIHRvIHVzZTpcbiAgICogICAgICAgICAgW2hhbmRsZV0gYSBoYW5kbGUgdG8gdGhlIHdpbmRvdyAob3IgYSBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG9cbiAgICogICAgICAgICAgICBhIGhhbmRsZSkgdG8gc2VuZCBtZXNzYWdlcyB0b1xuICAgKiAgICAgICAgICAgIChkZWZhdWx0cyB0byBgd2luZG93LnBhcmVudCB8fCB3aW5kb3cub3BlbmVyYCkuXG4gICAqXG4gICAqIEByZXR1cm4gYSBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gYW4gUlBDIGluamVjdG9yIG9uY2UgY29ubmVjdGVkLlxuICAgKi9cbiAgYXN5bmMgY29ubmVjdChvcmlnaW4sIG9wdGlvbnMpIHtcbiAgICBpZih0aGlzLl9saXN0ZW5lcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdBbHJlYWR5IGNvbm5lY3RlZC4nKTtcbiAgICB9XG5cbiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblxuICAgIC8vIFRPRE86IHZhbGlkYXRlIGBvcmlnaW5gIGFuZCBgb3B0aW9ucy5oYW5kbGVgXG4gICAgY29uc3Qgc2VsZiA9IHRoaXM7XG4gICAgc2VsZi5vcmlnaW4gPSB1dGlscy5wYXJzZVVybChvcmlnaW4pLm9yaWdpbjtcbiAgICBzZWxmLl9oYW5kbGUgPSBvcHRpb25zLmhhbmRsZSB8fCB3aW5kb3cucGFyZW50IHx8IHdpbmRvdy5vcGVuZXI7XG5cbiAgICBjb25zdCBwZW5kaW5nID0gc2VsZi5fcGVuZGluZztcbiAgICBzZWxmLl9saXN0ZW5lciA9IHV0aWxzLmNyZWF0ZU1lc3NhZ2VMaXN0ZW5lcih7XG4gICAgICBvcmlnaW46IHNlbGYub3JpZ2luLFxuICAgICAgaGFuZGxlOiBzZWxmLl9oYW5kbGUsXG4gICAgICBleHBlY3RSZXF1ZXN0OiBmYWxzZSxcbiAgICAgIGxpc3RlbmVyOiBtZXNzYWdlID0+IHtcbiAgICAgICAgLy8gaWdub3JlIG1lc3NhZ2VzIHRoYXQgaGF2ZSBubyBtYXRjaGluZywgcGVuZGluZyByZXF1ZXN0XG4gICAgICAgIGlmKCFwZW5kaW5nLmhhcyhtZXNzYWdlLmlkKSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHJlc29sdmUgb3IgcmVqZWN0IFByb21pc2UgYXNzb2NpYXRlZCB3aXRoIG1lc3NhZ2VcbiAgICAgICAgY29uc3Qge3Jlc29sdmUsIHJlamVjdCwgY2FuY2VsVGltZW91dH0gPSBwZW5kaW5nLmdldChtZXNzYWdlLmlkKTtcbiAgICAgICAgY2FuY2VsVGltZW91dCgpO1xuICAgICAgICBpZigncmVzdWx0JyBpbiBtZXNzYWdlKSB7XG4gICAgICAgICAgcmV0dXJuIHJlc29sdmUobWVzc2FnZS5yZXN1bHQpO1xuICAgICAgICB9XG4gICAgICAgIHJlamVjdCh1dGlscy5kZXNlcmlhbGl6ZUVycm9yKG1lc3NhZ2UuZXJyb3IpKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIHNlbGYuX2xpc3RlbmVyKTtcblxuICAgIHJldHVybiBuZXcgSW5qZWN0b3Ioc2VsZik7XG4gIH1cblxuICAvKipcbiAgICogUGVyZm9ybXMgYSBSUEMgYnkgc2VuZGluZyBhIG1lc3NhZ2UgdG8gdGhlIFdlYiBSZXF1ZXN0IFJQQyBzZXJ2ZXIgYW5kXG4gICAqIGF3YWl0aW5nIGEgcmVzcG9uc2UuXG4gICAqXG4gICAqIEBwYXJhbSBxdWFsaWZpZWRNZXRob2ROYW1lIHRoZSBmdWxseS1xdWFsaWZpZWQgbmFtZSBvZiB0aGUgbWV0aG9kIHRvIGNhbGwuXG4gICAqIEBwYXJhbSBwYXJhbWV0ZXJzIHRoZSBwYXJhbWV0ZXJzIGZvciB0aGUgbWV0aG9kLlxuICAgKiBAcGFyYW0gb3B0aW9ucyB0aGUgb3B0aW9ucyB0byB1c2U6XG4gICAqICAgICAgICAgIFt0aW1lb3V0XSBhIHRpbWVvdXQsIGluIG1pbGxpc2Vjb25kcywgZm9yIGF3YWl0aW5nIGEgcmVzcG9uc2U7XG4gICAqICAgICAgICAgICAgYSBub24tcG9zaXRpdmUgdGltZW91dCAoPD0gMCkgd2lsbCBjYXVzZSBhbiBpbmRlZmluaXRlIHdhaXQuXG4gICAqXG4gICAqIEByZXR1cm4gYSBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIHJlc3VsdCAob3IgZXJyb3IpIG9mIHRoZSBjYWxsLlxuICAgKi9cbiAgYXN5bmMgc2VuZChxdWFsaWZpZWRNZXRob2ROYW1lLCBwYXJhbWV0ZXJzLCB7XG4gICAgdGltZW91dCA9IFJQQ19DTElFTlRfQ0FMTF9USU1FT1VUXG4gIH0pIHtcbiAgICBpZighdGhpcy5fbGlzdGVuZXIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignUlBDIGNsaWVudCBub3QgY29ubmVjdGVkLicpO1xuICAgIH1cblxuICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgY29uc3QgbWVzc2FnZSA9IHtcbiAgICAgIGpzb25ycGM6ICcyLjAnLFxuICAgICAgaWQ6IHV0aWxzLnV1aWR2NCgpLFxuICAgICAgbWV0aG9kOiBxdWFsaWZpZWRNZXRob2ROYW1lLFxuICAgICAgcGFyYW1zOiBwYXJhbWV0ZXJzXG4gICAgfTtcblxuICAgIC8vIEhBQ0s6IHdlIGNhbid0IGp1c3QgYFByb21pc2UucmVzb2x2ZShoYW5kbGUpYCBiZWNhdXNlIENocm9tZSBoYXNcbiAgICAvLyBhIGJ1ZyB0aGF0IHRocm93cyBhbiBleGNlcHRpb24gaWYgdGhlIGhhbmRsZSBpcyBjcm9zcyBkb21haW5cbiAgICBpZih1dGlscy5pc0hhbmRsZVByb21pc2Uoc2VsZi5faGFuZGxlKSkge1xuICAgICAgY29uc3QgaGFuZGxlID0gYXdhaXQgc2VsZi5faGFuZGxlO1xuICAgICAgaGFuZGxlLnBvc3RNZXNzYWdlKG1lc3NhZ2UsIHNlbGYub3JpZ2luKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2VsZi5faGFuZGxlLnBvc3RNZXNzYWdlKG1lc3NhZ2UsIHNlbGYub3JpZ2luKTtcbiAgICB9XG5cbiAgICAvLyByZXR1cm4gUHJvbWlzZSB0aGF0IHdpbGwgcmVzb2x2ZSBvbmNlIGEgcmVzcG9uc2UgbWVzc2FnZSBoYXMgYmVlblxuICAgIC8vIHJlY2VpdmVkIG9yIG9uY2UgYSB0aW1lb3V0IG9jY3Vyc1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBjb25zdCBwZW5kaW5nID0gc2VsZi5fcGVuZGluZztcbiAgICAgIGxldCBjYW5jZWxUaW1lb3V0O1xuICAgICAgaWYodGltZW91dCA+IDApIHtcbiAgICAgICAgY29uc3QgdGltZW91dElkID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgcGVuZGluZy5kZWxldGUobWVzc2FnZS5pZCk7XG4gICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcignUlBDIGNhbGwgdGltZWQgb3V0LicpKTtcbiAgICAgICAgfSwgdGltZW91dCk7XG4gICAgICAgIGNhbmNlbFRpbWVvdXQgPSAoKSA9PiB7XG4gICAgICAgICAgcGVuZGluZy5kZWxldGUobWVzc2FnZS5pZCk7XG4gICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7XG4gICAgICAgIH07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjYW5jZWxUaW1lb3V0ID0gKCkgPT4ge1xuICAgICAgICAgIHBlbmRpbmcuZGVsZXRlKG1lc3NhZ2UuaWQpO1xuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgcGVuZGluZy5zZXQobWVzc2FnZS5pZCwge3Jlc29sdmUsIHJlamVjdCwgY2FuY2VsVGltZW91dH0pO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIERpc2Nvbm5lY3RzIGZyb20gdGhlIHJlbW90ZSBXZWIgUmVxdWVzdCBSUEMgc2VydmVyIGFuZCBjbG9zZXMgZG93biB0aGlzXG4gICAqIGNsaWVudC5cbiAgICovXG4gIGNsb3NlKCkge1xuICAgIGlmKHRoaXMuX2xpc3RlbmVyKSB7XG4gICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIHRoaXMuX2xpc3RlbmVyKTtcbiAgICAgIHRoaXMuX2hhbmRsZSA9IHRoaXMub3JpZ2luID0gdGhpcy5fbGlzdGVuZXIgPSBudWxsO1xuICAgICAgLy8gcmVqZWN0IGFsbCBwZW5kaW5nIGNhbGxzXG4gICAgICBmb3IoY29uc3QgdmFsdWUgb2YgdGhpcy5fcGVuZGluZy52YWx1ZXMoKSkge1xuICAgICAgICB2YWx1ZS5yZWplY3QobmV3IEVycm9yKCdSUEMgY2xpZW50IGNsb3NlZC4nKSk7XG4gICAgICB9XG4gICAgICB0aGlzLl9wZW5kaW5nID0gbmV3IE1hcCgpO1xuICAgIH1cbiAgfVxufVxuXG5jbGFzcyBJbmplY3RvciB7XG4gIGNvbnN0cnVjdG9yKGNsaWVudCkge1xuICAgIHRoaXMuY2xpZW50ID0gY2xpZW50O1xuICAgIHRoaXMuX2FwaXMgPSBuZXcgTWFwKCk7XG4gIH1cblxuICAvKipcbiAgICogRGVmaW5lcyBhIG5hbWVkIEFQSSB0aGF0IHdpbGwgdXNlIGFuIFJQQyBjbGllbnQgdG8gaW1wbGVtZW50IGl0c1xuICAgKiBmdW5jdGlvbnMuIEVhY2ggb2YgdGhlc2UgZnVuY3Rpb25zIHdpbGwgYmUgYXN5bmNocm9ub3VzIGFuZCByZXR1cm4gYVxuICAgKiBQcm9taXNlIHdpdGggdGhlIHJlc3VsdCBmcm9tIHRoZSBSUEMgc2VydmVyLlxuICAgKlxuICAgKiBUaGlzIGZ1bmN0aW9uIHdpbGwgcmV0dXJuIGFuIGludGVyZmFjZSB3aXRoIGZ1bmN0aW9ucyBkZWZpbmVkIGFjY29yZGluZ1xuICAgKiB0byB0aG9zZSBwcm92aWRlZCBpbiB0aGUgZ2l2ZW4gYGRlZmluaXRpb25gLiBUaGUgYG5hbWVgIHBhcmFtZXRlciBjYW4gYmVcbiAgICogdXNlZCB0byBvYnRhaW4gdGhpcyBjYWNoZWQgaW50ZXJmYWNlIHZpYSBgLmdldChuYW1lKWAuXG4gICAqXG4gICAqIEBwYXJhbSBuYW1lIHRoZSBuYW1lIG9mIHRoZSBBUEkuXG4gICAqIEBwYXJhbSBkZWZpbml0aW9uIHRoZSBkZWZpbml0aW9uIGZvciB0aGUgQVBJLCBpbmNsdWRpbmc6XG4gICAqICAgICAgICAgIGZ1bmN0aW9uczogYW4gYXJyYXkgb2YgZnVuY3Rpb24gbmFtZXMgKGFzIHN0cmluZ3MpIG9yIG9iamVjdHNcbiAgICogICAgICAgICAgICBjb250YWluaW5nOiB7bmFtZTogPGZ1bmN0aW9uTmFtZT4sIG9wdGlvbnM6IDxycGNDbGllbnRPcHRpb25zPn0uXG4gICAqXG4gICAqIEByZXR1cm4gYW4gaW50ZXJmYWNlIHdpdGggdGhlIGZ1bmN0aW9ucyBwcm92aWRlZCB2aWEgYGRlZmluaXRpb25gIHRoYXRcbiAgICogICAgICAgICAgIHdpbGwgbWFrZSBSUEMgY2FsbHMgdG8gYW4gUlBDIHNlcnZlciB0byBwcm92aWRlIHRoZWlyXG4gICAqICAgICAgICAgICBpbXBsZW1lbnRhdGlvbi5cbiAgICovXG4gIGRlZmluZShuYW1lLCBkZWZpbml0aW9uKSB7XG4gICAgaWYoIShuYW1lICYmIHR5cGVvZiBuYW1lID09PSAnc3RyaW5nJykpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2BuYW1lYCBtdXN0IGJlIGEgbm9uLWVtcHR5IHN0cmluZy4nKTtcbiAgICB9XG4gICAgLy8gVE9ETzogc3VwcG9ydCBXZWIgSURMIGFzIGEgZGVmaW5pdGlvbiBmb3JtYXQ/XG4gICAgaWYoIShkZWZpbml0aW9uICYmIHR5cGVvZiBkZWZpbml0aW9uID09PSAnb2JqZWN0JyAmJlxuICAgICAgQXJyYXkuaXNBcnJheShkZWZpbml0aW9uLmZ1bmN0aW9ucykpKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFxuICAgICAgICAnYGRlZmluaXRpb24uZnVuY3Rpb25gIG11c3QgYmUgYW4gYXJyYXkgb2YgZnVuY3Rpb24gbmFtZXMgb3IgJyArXG4gICAgICAgICdmdW5jdGlvbiBkZWZpbml0aW9uIG9iamVjdHMgdG8gYmUgZGVmaW5lZC4nKTtcbiAgICB9XG5cbiAgICBjb25zdCBzZWxmID0gdGhpcztcbiAgICBjb25zdCBhcGkgPSB7fTtcblxuICAgIGRlZmluaXRpb24uZnVuY3Rpb25zLmZvckVhY2goZm4gPT4ge1xuICAgICAgaWYodHlwZW9mIGZuID09PSAnc3RyaW5nJykge1xuICAgICAgICBmbiA9IHtuYW1lOiBmbiwgb3B0aW9uczoge319O1xuICAgICAgfVxuICAgICAgYXBpW2ZuLm5hbWVdID0gYXN5bmMgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBzZWxmLmNsaWVudC5zZW5kKFxuICAgICAgICAgIG5hbWUgKyAnLicgKyBmbi5uYW1lLCBbLi4uYXJndW1lbnRzXSwgZm4ub3B0aW9ucyk7XG4gICAgICB9O1xuICAgIH0pO1xuXG4gICAgc2VsZi5fYXBpc1tuYW1lXSA9IGFwaTtcbiAgICByZXR1cm4gYXBpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBhIG5hbWVkIEFQSSwgZGVmaW5pbmcgaXQgaWYgbmVjZXNzYXJ5IHdoZW4gYSBkZWZpbml0aW9uIGlzIHByb3ZpZGVkLlxuICAgKlxuICAgKiBAcGFyYW0gbmFtZSB0aGUgbmFtZSBvZiB0aGUgQVBJLlxuICAgKiBAcGFyYW0gW2RlZmluaXRpb25dIHRoZSBkZWZpbml0aW9uIGZvciB0aGUgQVBJOyBpZiB0aGUgQVBJIGlzIGFscmVhZHlcbiAgICogICAgICAgICAgZGVmaW5lZCwgdGhpcyBkZWZpbml0aW9uIGlzIGlnbm9yZWQuXG4gICAqXG4gICAqIEByZXR1cm4gdGhlIGludGVyZmFjZS5cbiAgICovXG4gIGdldChuYW1lLCBkZWZpbml0aW9uKSB7XG4gICAgY29uc3QgYXBpID0gdGhpcy5fYXBpc1tuYW1lXTtcbiAgICBpZighYXBpKSB7XG4gICAgICBpZihkZWZpbml0aW9uKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRlZmluZShuYW1lLCBkZWZpbml0aW9uKTtcbiAgICAgIH1cbiAgICAgIHRocm93IG5ldyBFcnJvcihgQVBJIFwiJHtuYW1lfVwiIGhhcyBub3QgYmVlbiBkZWZpbmVkLmApO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5fYXBpc1tuYW1lXTtcbiAgfVxufVxuIiwiLyohXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTcgRGlnaXRhbCBCYXphYXIsIEluYy4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqL1xuJ3VzZSBzdHJpY3QnO1xuXG5leHBvcnQgY2xhc3MgRXZlbnRFbWl0dGVyIHtcbiAgY29uc3RydWN0b3Ioe2Rlc2VyaWFsaXplID0gZSA9PiBlLCB3YWl0VW50aWwgPSBhc3luYyAoKSA9PiB7fX0gPSB7fSkge1xuICAgIHRoaXMuX2xpc3RlbmVycyA9IFtdO1xuICAgIHRoaXMuX2Rlc2VyaWFsaXplID0gZGVzZXJpYWxpemU7XG4gICAgdGhpcy5fd2FpdFVudGlsID0gd2FpdFVudGlsO1xuICB9XG5cbiAgYXN5bmMgZW1pdChldmVudCkge1xuICAgIGV2ZW50ID0gdGhpcy5fZGVzZXJpYWxpemUoZXZlbnQpO1xuICAgICh0aGlzLl9saXN0ZW5lcnNbZXZlbnQudHlwZV0gfHwgW10pLmZvckVhY2gobCA9PiBsKGV2ZW50KSk7XG4gICAgcmV0dXJuIHRoaXMuX3dhaXRVbnRpbChldmVudCk7XG4gIH1cblxuICBhZGRFdmVudExpc3RlbmVyKGV2ZW50VHlwZSwgZm4pIHtcbiAgICBpZighdGhpcy5fbGlzdGVuZXJzW2V2ZW50VHlwZV0pIHtcbiAgICAgIHRoaXMuX2xpc3RlbmVyc1tldmVudFR5cGVdID0gW2ZuXTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fbGlzdGVuZXJzW2V2ZW50VHlwZV0ucHVzaChmbik7XG4gICAgfVxuICB9XG5cbiAgcmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudFR5cGUsIGZuKSB7XG4gICAgY29uc3QgbGlzdGVuZXJzID0gdGhpcy5fbGlzdGVuZXJzW2V2ZW50VHlwZV07XG4gICAgaWYoIWxpc3RlbmVycykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBpZHggPSBsaXN0ZW5lcnMuaW5kZXhPZihmbik7XG4gICAgaWYoaWR4ICE9PSAtMSkge1xuICAgICAgbGlzdGVuZXJzLnNwbGljZShpZHgsIDEpO1xuICAgIH1cbiAgfVxufVxuIiwiLyohXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTcgRGlnaXRhbCBCYXphYXIsIEluYy4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqL1xuJ3VzZSBzdHJpY3QnO1xuXG5pbXBvcnQgKiBhcyB1dGlscyBmcm9tICcuL3V0aWxzLmpzJztcblxuZXhwb3J0IGNsYXNzIFNlcnZlciB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMub3JpZ2luID0gbnVsbDtcbiAgICB0aGlzLl9oYW5kbGUgPSBudWxsO1xuICAgIHRoaXMuX2FwaXMgPSBuZXcgTWFwKCk7XG4gIH1cblxuICAvKipcbiAgICogUHJvdmlkZXMgYW4gaW1wbGVtZW50YXRpb24gZm9yIGEgbmFtZWQgQVBJLiBBbGwgZnVuY3Rpb25zIGluIHRoZSBnaXZlblxuICAgKiBBUEkgd2lsbCBiZSBtYWRlIGNhbGxhYmxlIHZpYSBSUEMgY2xpZW50cyBjb25uZWN0ZWQgdG8gdGhpcyBzZXJ2ZXIuXG4gICAqXG4gICAqIEBwYXJhbSBuYW1lIHRoZSBuYW1lIG9mIHRoZSBBUEkuXG4gICAqIEBwYXJhbSBhcGkgdGhlIEFQSSB0byBhZGQuXG4gICAqL1xuICBkZWZpbmUobmFtZSwgYXBpKSB7XG4gICAgaWYoIShuYW1lICYmIHR5cGVvZiBuYW1lID09PSAnc3RyaW5nJykpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2BuYW1lYCBtdXN0IGJlIGEgbm9uLWVtcHR5IHN0cmluZy4nKTtcbiAgICB9XG4gICAgaWYoIShhcGkgJiYgYXBpICE9PSAnb2JqZWN0JykpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2BhcGlgIG11c3QgYmUgYW4gb2JqZWN0LicpO1xuICAgIH1cbiAgICBpZihuYW1lIGluIHRoaXMuX2FwaXMpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgVGhlIFwiJHtuYW1lfVwiIEFQSSBpcyBhbHJlYWR5IGRlZmluZWQuYCk7XG4gICAgfVxuXG4gICAgdGhpcy5fYXBpc1tuYW1lXSA9IGFwaTtcbiAgfVxuXG4gIC8qKlxuICAgKiBMaXN0ZW5zIGZvciBSUEMgbWVzc2FnZXMgZnJvbSBjbGllbnRzIGZyb20gYSBwYXJ0aWN1bGFyIG9yaWdpbiBhbmRcbiAgICogd2luZG93IGhhbmRsZSBhbmQgdXNlcyB0aGVtIHRvIGV4ZWN1dGUgQVBJIGNhbGxzIGJhc2VkIG9uIHByZWRlZmluZWRcbiAgICogQVBJcy5cbiAgICpcbiAgICogSWYgbWVzc2FnZXMgYXJlIG5vdCBmcm9tIHRoZSBnaXZlbiBvcmlnaW4gb3Igd2luZG93IGhhbmRsZSwgdGhleSBhcmVcbiAgICogaWdub3JlZC4gSWYgdGhlIG1lc3NhZ2VzIHJlZmVyIHRvIG5hbWVkIEFQSXMgdGhhdCBoYXZlIG5vdCBiZWVuIGRlZmluZWRcbiAgICogdGhlbiBhbiBlcnJvciBtZXNzYWdlIGlzIHNlbnQgaW4gcmVzcG9uc2UuIFRoZXNlIGVycm9yIG1lc3NhZ2VzIGNhblxuICAgKiBiZSBzdXBwcmVzc2VkIGJ5IHVzaW5nIHRoZSBgaWdub3JlVW5rbm93bkFwaWAgb3B0aW9uLlxuICAgKlxuICAgKiBJZiBhIG1lc3NhZ2UgcmVmZXJzIHRvIGFuIHVua25vd24gbWV0aG9kIG9uIGEga25vd24gbmFtZWQgQVBJLCB0aGVuIGFuXG4gICAqIGVycm9yIG1lc3NhZ2UgaXMgc2VudCBpbiByZXNwb25zZS5cbiAgICpcbiAgICogQHBhcmFtIG9yaWdpbiB0aGUgb3JpZ2luIHRvIGxpc3RlbiBmb3IuXG4gICAqIEBwYXJhbSBvcHRpb25zIHRoZSBvcHRpb25zIHRvIHVzZTpcbiAgICogICAgICAgICAgW2hhbmRsZV0gYSBoYW5kbGUgdG8gdGhlIHdpbmRvdyAob3IgYSBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG9cbiAgICogICAgICAgICAgICBhIGhhbmRsZSkgdG8gbGlzdGVuIGZvciBtZXNzYWdlcyBmcm9tXG4gICAqICAgICAgICAgICAgKGRlZmF1bHRzIHRvIGB3aW5kb3cucGFyZW50IHx8IHdpbmRvdy5vcGVuZXJgKS5cbiAgICogICAgICAgICAgW2lnbm9yZVVua25vd25BcGldIGB0cnVlYCB0byBpZ25vcmUgdW5rbm93biBBUEkgbWVzc2FnZXMuXG4gICAqL1xuICBhc3luYyBsaXN0ZW4ob3JpZ2luLCBvcHRpb25zKSB7XG4gICAgaWYodGhpcy5fbGlzdGVuZXIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQWxyZWFkeSBsaXN0ZW5pbmcuJyk7XG4gICAgfVxuXG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cbiAgICAvLyBUT0RPOiB2YWxpZGF0ZSBgb3JpZ2luYCBhbmQgYG9wdGlvbnMuaGFuZGxlYFxuICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuICAgIHNlbGYub3JpZ2luID0gdXRpbHMucGFyc2VVcmwob3JpZ2luKS5vcmlnaW47XG4gICAgc2VsZi5faGFuZGxlID0gb3B0aW9ucy5oYW5kbGUgfHwgd2luZG93LnBhcmVudCB8fCB3aW5kb3cub3BlbmVyO1xuXG4gICAgY29uc3QgaWdub3JlVW5rbm93bkFwaSA9IChvcHRpb25zLmlnbm9yZVVua25vd25BcGkgPT09ICd0cnVlJykgfHwgZmFsc2U7XG5cbiAgICBzZWxmLl9saXN0ZW5lciA9IHV0aWxzLmNyZWF0ZU1lc3NhZ2VMaXN0ZW5lcih7XG4gICAgICBvcmlnaW46IHNlbGYub3JpZ2luLFxuICAgICAgaGFuZGxlOiBzZWxmLl9oYW5kbGUsXG4gICAgICBleHBlY3RSZXF1ZXN0OiB0cnVlLFxuICAgICAgbGlzdGVuZXI6IG1lc3NhZ2UgPT4ge1xuICAgICAgICBjb25zdCB7bmFtZSwgbWV0aG9kfSA9IHV0aWxzLmRlc3RydWN0dXJlTWV0aG9kTmFtZShtZXNzYWdlLm1ldGhvZCk7XG4gICAgICAgIGNvbnN0IGFwaSA9IHNlbGYuX2FwaXNbbmFtZV07XG5cbiAgICAgICAgLy8gZG8gbm90IGFsbG93IGNhbGxpbmcgXCJwcml2YXRlXCIgbWV0aG9kcyAoc3RhcnRzIHdpdGggYF9gKVxuICAgICAgICBpZihtZXRob2QgJiYgbWV0aG9kLnN0YXJ0c1dpdGgoJ18nKSkge1xuICAgICAgICAgIHJldHVybiBzZW5kTWV0aG9kTm90Rm91bmQoc2VsZi5faGFuZGxlLCBzZWxmLm9yaWdpbiwgbWVzc2FnZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBUEkgbm90IGZvdW5kIGJ1dCBpZ25vcmUgZmxhZyBpcyBvblxuICAgICAgICBpZighYXBpICYmIGlnbm9yZVVua25vd25BcGkpIHtcbiAgICAgICAgICAvLyBBUEkgbm90IHJlZ2lzdGVyZWQsIGlnbm9yZSB0aGUgbWVzc2FnZSByYXRoZXIgdGhhbiByYWlzZSBlcnJvclxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIG5vIGlnbm9yZSBmbGFnIGFuZCB1bmtub3duIEFQSSBvciB1bmtub3duIHNwZWNpZmljIG1ldGhvZFxuICAgICAgICBpZighYXBpIHx8IHR5cGVvZiBhcGlbbWV0aG9kXSAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgIHJldHVybiBzZW5kTWV0aG9kTm90Rm91bmQoc2VsZi5faGFuZGxlLCBzZWxmLm9yaWdpbiwgbWVzc2FnZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBUEkgYW5kIHNwZWNpZmljIGZ1bmN0aW9uIGZvdW5kXG4gICAgICAgIGNvbnN0IGZuID0gYXBpW21ldGhvZF07XG4gICAgICAgIChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSB7XG4gICAgICAgICAgICBqc29ucnBjOiAnMi4wJyxcbiAgICAgICAgICAgIGlkOiBtZXNzYWdlLmlkXG4gICAgICAgICAgfTtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmVzcG9uc2UucmVzdWx0ID0gYXdhaXQgZm4uYXBwbHkoYXBpLCBtZXNzYWdlLnBhcmFtcyk7XG4gICAgICAgICAgfSBjYXRjaChlKSB7XG4gICAgICAgICAgICByZXNwb25zZS5lcnJvciA9IHV0aWxzLnNlcmlhbGl6ZUVycm9yKGUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvLyBpZiBzZXJ2ZXIgZGlkIG5vdCBgY2xvc2VgIHdoaWxlIHdlIHdhaXRlZCBmb3IgYSByZXNwb25zZVxuICAgICAgICAgIGlmKHNlbGYuX2hhbmRsZSkge1xuICAgICAgICAgICAgLy8gSEFDSzogd2UgY2FuJ3QganVzdCBgUHJvbWlzZS5yZXNvbHZlKGhhbmRsZSlgIGJlY2F1c2UgQ2hyb21lIGhhc1xuICAgICAgICAgICAgLy8gYSBidWcgdGhhdCB0aHJvd3MgYW4gZXhjZXB0aW9uIGlmIHRoZSBoYW5kbGUgaXMgY3Jvc3MgZG9tYWluXG4gICAgICAgICAgICBpZih1dGlscy5pc0hhbmRsZVByb21pc2Uoc2VsZi5faGFuZGxlKSkge1xuICAgICAgICAgICAgICBzZWxmLl9oYW5kbGUudGhlbihoID0+IGgucG9zdE1lc3NhZ2UocmVzcG9uc2UsIHNlbGYub3JpZ2luKSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBzZWxmLl9oYW5kbGUucG9zdE1lc3NhZ2UocmVzcG9uc2UsIHNlbGYub3JpZ2luKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0pKCk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBzZWxmLl9saXN0ZW5lcik7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICBpZih0aGlzLl9saXN0ZW5lcikge1xuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCB0aGlzLl9saXN0ZW5lcik7XG4gICAgICB0aGlzLl9oYW5kbGUgPSB0aGlzLm9yaWdpbiA9IHRoaXMuX2xpc3RlbmVyID0gbnVsbDtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gc2VuZE1ldGhvZE5vdEZvdW5kKGhhbmRsZSwgb3JpZ2luLCBtZXNzYWdlKSB7XG4gIGNvbnN0IHJlc3BvbnNlID0ge1xuICAgIGpzb25ycGM6ICcyLjAnLFxuICAgIGlkOiBtZXNzYWdlLmlkLFxuICAgIGVycm9yOiBPYmplY3QuYXNzaWduKHt9LCB1dGlscy5SUENfRVJST1JTLk1ldGhvZE5vdEZvdW5kKVxuICB9O1xuICAvLyBIQUNLOiB3ZSBjYW4ndCBqdXN0IGBQcm9taXNlLnJlc29sdmUoaGFuZGxlKWAgYmVjYXVzZSBDaHJvbWUgaGFzXG4gIC8vIGEgYnVnIHRoYXQgdGhyb3dzIGFuIGV4Y2VwdGlvbiBpZiB0aGUgaGFuZGxlIGlzIGNyb3NzIGRvbWFpblxuICBpZih1dGlscy5pc0hhbmRsZVByb21pc2UoaGFuZGxlKSkge1xuICAgIHJldHVybiBoYW5kbGUudGhlbihoID0+IGgucG9zdE1lc3NhZ2UocmVzcG9uc2UsIG9yaWdpbikpO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBoYW5kbGUucG9zdE1lc3NhZ2UocmVzcG9uc2UsIG9yaWdpbik7XG4gIH1cbn1cbiIsIi8qIVxuICogQSBXZWJBcHAgaXMgYSByZW1vdGUgYXBwbGljYXRpb24gdGhhdCBydW5zIGluIGEgV2ViQXBwQ29udGV4dC5cbiAqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTcgRGlnaXRhbCBCYXphYXIsIEluYy4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqL1xuJ3VzZSBzdHJpY3QnO1xuXG5pbXBvcnQge0NsaWVudH0gZnJvbSAnLi9DbGllbnQuanMnO1xuaW1wb3J0IHtTZXJ2ZXJ9IGZyb20gJy4vU2VydmVyLmpzJztcbmltcG9ydCB7cGFyc2VVcmx9IGZyb20gJy4vdXRpbHMuanMnO1xuXG5leHBvcnQgY2xhc3MgV2ViQXBwIHtcbiAgY29uc3RydWN0b3IocmVseWluZ09yaWdpbikge1xuICAgIC8vIHRoaXMgaXMgdGhlIG9yaWdpbiB0aGF0IGNyZWF0ZWQgdGhlIFdlYkFwcENvbnRleHQgdG8gcnVuIGl0IGluXG4gICAgLy8gVE9ETzogYmV0dGVyIG5hbWU/IGBjb250ZXh0T3JpZ2luYD9cbiAgICB0aGlzLnJlbHlpbmdPcmlnaW4gPSBwYXJzZVVybChyZWx5aW5nT3JpZ2luKS5vcmlnaW47XG4gICAgdGhpcy5jbGllbnQgPSBudWxsO1xuICAgIHRoaXMuaW5qZWN0b3IgPSBudWxsO1xuICAgIHRoaXMuY2xpZW50ID0gbmV3IENsaWVudCgpO1xuICAgIHRoaXMuc2VydmVyID0gbmV3IFNlcnZlcigpO1xuXG4gICAgdGhpcy5fY29udHJvbCA9IG51bGw7XG4gICAgdGhpcy5fY29ubmVjdGVkID0gZmFsc2U7XG4gIH1cblxuICAvKipcbiAgICogQ29ubmVjdHMgdGhpcyBXZWJBcHAgdG8gdGhlIHJlbHlpbmcgb3JpZ2luIHRoYXQgaW5zdGFudGlhdGVkIGl0LiBPbmNlXG4gICAqIGNvbm5lY3RlZCwgdGhlIFdlYkFwcCBjYW4gc3RhcnQgc2VydmljaW5nIGNhbGxzIGZyb20gdGhhdCBvcmlnaW4uXG4gICAqXG4gICAqIEByZXR1cm4gYSBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gYW4gaW5qZWN0b3IgZm9yIGNyZWF0aW5nIGN1c3RvbSBjbGllbnRcbiAgICogICAgICAgICAgIEFQSXMgb25jZSB0aGUgY29ubmVjdGlvbiBpcyByZWFkeS5cbiAgICovXG4gIGFzeW5jIGNvbm5lY3QoKSB7XG4gICAgdGhpcy5pbmplY3RvciA9IGF3YWl0IHRoaXMuY2xpZW50LmNvbm5lY3QodGhpcy5yZWx5aW5nT3JpZ2luKTtcbiAgICB0aGlzLl9jb25uZWN0ZWQgPSB0cnVlO1xuICAgIHRoaXMuX2NvbnRyb2wgPSB0aGlzLmluamVjdG9yLmRlZmluZSgnY29yZS5jb250cm9sJywge1xuICAgICAgZnVuY3Rpb25zOiBbJ3JlYWR5JywgJ3Nob3cnLCAnaGlkZSddXG4gICAgfSk7XG4gICAgdGhpcy5zZXJ2ZXIubGlzdGVuKHRoaXMucmVseWluZ09yaWdpbik7XG4gICAgcmV0dXJuIHRoaXMuaW5qZWN0b3I7XG4gIH1cblxuICAvKipcbiAgICogTXVzdCBiZSBjYWxsZWQgYWZ0ZXIgYGNvbm5lY3RgIHdoZW4gdGhpcyBXZWJBcHAgaXMgcmVhZHkgdG8gc3RhcnRcbiAgICogcmVjZWl2aW5nIGNhbGxzIGZyb20gdGhlIHJlbW90ZSBlbmQuXG4gICAqL1xuICBhc3luYyByZWFkeSgpIHtcbiAgICBpZighdGhpcy5fY29ubmVjdGVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1dlYkFwcCBub3QgY29ubmVjdGVkLiBEaWQgeW91IGNhbGwgXCIuY29ubmVjdCgpXCI/Jyk7XG4gICAgfVxuICAgIGF3YWl0IHRoaXMuX2NvbnRyb2wucmVhZHkoKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBDbG9zZXMgdGhpcyBXZWJBcHAncyBjb25uZWN0aW9uIHRvIHRoZSByZWx5aW5nIG9yaWdpbi5cbiAgICovXG4gIGNsb3NlKCkge1xuICAgIGlmKHRoaXMuX2Nvbm5lY3RlZCkge1xuICAgICAgdGhpcy5zZXJ2ZXIuY2xvc2UoKTtcbiAgICAgIHRoaXMuY2xpZW50LmNsb3NlKCk7XG4gICAgICB0aGlzLl9jb25uZWN0ZWQgPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU2hvd3MgdGhlIFVJIGZvciB0aGlzIFdlYkFwcCBvbiB0aGUgcmVseWluZyBvcmlnaW4uXG4gICAqL1xuICBhc3luYyBzaG93KCkge1xuICAgIGlmKCF0aGlzLl9jb25uZWN0ZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgJ0Nhbm5vdCBcInNob3dcIiB5ZXQ7IG5vdCBjb25uZWN0ZWQuIERpZCB5b3UgY2FsbCBcIi5jb25uZWN0KClcIj8nKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuX2NvbnRyb2wuc2hvdygpO1xuICB9XG5cbiAgLyoqXG4gICAqIEhpZGVzIHRoZSBVSSBmb3IgdGhpcyBXZWJBcHAgb24gdGhlIHJlbHlpbmcgb3JpZ2luLlxuICAgKi9cbiAgYXN5bmMgaGlkZSgpIHtcbiAgICBpZighdGhpcy5fY29ubmVjdGVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICdDYW5ub3QgXCJoaWRlXCIgeWV0OyBub3QgY29ubmVjdGVkLiBEaWQgeW91IGNhbGwgXCIuY29ubmVjdCgpP1wiJyk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLl9jb250cm9sLmhpZGUoKTtcbiAgfVxufVxuIiwiLyohXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTctMjAxOCBEaWdpdGFsIEJhemFhciwgSW5jLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICovXG4ndXNlIHN0cmljdCc7XG5cbi8vIGRlZmF1bHQgdGltZW91dCBpcyA2MCBzZWNvbmRzXG5jb25zdCBMT0FEX1dJTkRPV19USU1FT1VUID0gNjAwMDA7XG5cbi8qKlxuICogUHJvdmlkZXMgYSB3aW5kb3cgYW5kIEFQSSBmb3IgcmVtb3RlIFdlYiBhcHBsaWNhdGlvbnMuIFRoaXMgQVBJIGlzIHR5cGljYWxseVxuICogdXNlZCBieSBSUEMgV2ViQXBwcyB0aGF0IHJ1biBpbiBhIFdlYkFwcENvbnRleHQgdG8gaW5kaWNhdGUgd2hlbiB0aGV5IGFyZVxuICogcmVhZHkgYW5kIHRvIHNob3cvaGlkZSB0aGVpciBVSS5cbiAqL1xuZXhwb3J0IGNsYXNzIFdlYkFwcFdpbmRvdyB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIHVybCwge1xuICAgICAgdGltZW91dCA9IExPQURfV0lORE9XX1RJTUVPVVQsXG4gICAgICBoYW5kbGUsXG4gICAgICBpZnJhbWUsXG4gICAgICB3aW5kb3dDb250cm9sLFxuICAgICAgY2xhc3NOYW1lID0gbnVsbCxcbiAgICAgIGN1c3RvbWl6ZSA9IG51bGxcbiAgICB9ID0ge30pIHtcbiAgICB0aGlzLnZpc2libGUgPSBmYWxzZTtcbiAgICB0aGlzLmRpYWxvZyA9IG51bGw7XG4gICAgdGhpcy5pZnJhbWUgPSBudWxsO1xuICAgIHRoaXMuaGFuZGxlID0gbnVsbDtcbiAgICB0aGlzLndpbmRvd0NvbnRyb2wgPSBudWxsO1xuICAgIHRoaXMuX3JlYWR5ID0gZmFsc2U7XG4gICAgdGhpcy5fcHJpdmF0ZSA9IHt9O1xuICAgIHRoaXMuX3RpbWVvdXRJZCA9IG51bGw7XG5cbiAgICAvLyBwcml2YXRlIHRvIGFsbG93IGNhbGxlciB0byB0cmFjayByZWFkaW5lc3NcbiAgICB0aGlzLl9wcml2YXRlLl9yZWFkeVByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAvLyByZWplY3QgaWYgdGltZW91dCByZWFjaGVkXG4gICAgICB0aGlzLl90aW1lb3V0SWQgPSBzZXRUaW1lb3V0KFxuICAgICAgICAoKSA9PiByZWplY3QobmV3IERPTUV4Y2VwdGlvbihcbiAgICAgICAgICAnTG9hZGluZyBXZWIgYXBwbGljYXRpb24gd2luZG93IHRpbWVkIG91dC4nLCAnVGltZW91dEVycm9yJykpLFxuICAgICAgICB0aW1lb3V0KTtcbiAgICAgIHRoaXMuX3ByaXZhdGUuX3Jlc29sdmVSZWFkeSA9IHZhbHVlID0+IHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZW91dElkKTtcbiAgICAgICAgdGhpcy5fdGltZW91dElkID0gbnVsbDtcbiAgICAgICAgcmVzb2x2ZSh2YWx1ZSk7XG4gICAgICB9O1xuICAgICAgdGhpcy5fcHJpdmF0ZS5fcmVqZWN0UmVhZHkgPSBlcnIgPT4ge1xuICAgICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lb3V0SWQpO1xuICAgICAgICB0aGlzLl90aW1lb3V0SWQgPSBudWxsO1xuICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgIH07XG4gICAgfSk7XG4gICAgdGhpcy5fcHJpdmF0ZS5pc1JlYWR5ID0gYXN5bmMgKCkgPT4ge1xuICAgICAgcmV0dXJuIHRoaXMuX3ByaXZhdGUuX3JlYWR5UHJvbWlzZTtcbiAgICB9O1xuXG4gICAgLy8gcHJpdmF0ZSB0byBkaXNhbGxvdyBkZXN0cnVjdGlvbiB2aWEgY2xpZW50XG4gICAgdGhpcy5fcHJpdmF0ZS5kZXN0cm95ID0gKCkgPT4ge1xuICAgICAgLy8gd2luZG93IG5vdCByZWFkeSB5ZXQsIGJ1dCBkZXN0cm95ZWRcbiAgICAgIGlmKHRoaXMuX3RpbWVvdXRJZCkge1xuICAgICAgICB0aGlzLl9wcml2YXRlLl9yZWplY3RSZWFkeShuZXcgRE9NRXhjZXB0aW9uKFxuICAgICAgICAgICdXZWIgYXBwbGljYXRpb24gd2luZG93IGNsb3NlZCBiZWZvcmUgcmVhZHkuJywgJ0Fib3J0RXJyb3InKSk7XG4gICAgICB9XG4gICAgICBpZih0aGlzLmRpYWxvZykge1xuICAgICAgICB0aGlzLmRpYWxvZy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuZGlhbG9nKTtcbiAgICAgICAgdGhpcy5kaWFsb2cgPSBudWxsO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBpZihpZnJhbWUpIHtcbiAgICAgIC8vIFRPRE86IHZhbGlkYXRlIGBpZnJhbWVgIG9wdGlvbiBhcyBtdWNoIGFzIHBvc3NpYmxlXG4gICAgICBpZighKHR5cGVvZiBpZnJhbWUgPT09ICdvYmplY3QnICYmIGlmcmFtZS5jb250ZW50V2luZG93KSkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdgb3B0aW9ucy5pZnJhbWVgIG11c3QgYmUgYW4gaWZyYW1lIGVsZW1lbnQuJyk7XG4gICAgICB9XG4gICAgICB0aGlzLndpbmRvd0NvbnRyb2wgPSB7XG4gICAgICAgIGhhbmRsZTogaWZyYW1lLmNvbnRlbnRXaW5kb3csXG4gICAgICAgIHNob3coKSB7XG4gICAgICAgICAgaWZyYW1lLnN0eWxlLnZpc2liaWxpdHkgPSAndmlzaWJsZSc7XG4gICAgICAgIH0sXG4gICAgICAgIGhpZGUoKSB7XG4gICAgICAgICAgaWZyYW1lLnN0eWxlLnZpc2liaWxpdHkgPSAnaGlkZGVuJztcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIHRoaXMuaWZyYW1lID0gaWZyYW1lO1xuICAgICAgdGhpcy5oYW5kbGUgPSB0aGlzLmlmcmFtZS5jb250ZW50V2luZG93O1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmKHdpbmRvd0NvbnRyb2wpIHtcbiAgICAgIC8vIFRPRE86IHZhbGlkYXRlIGB3aW5kb3dDb250cm9sYFxuICAgICAgdGhpcy53aW5kb3dDb250cm9sID0gd2luZG93Q29udHJvbDtcbiAgICAgIHRoaXMuaGFuZGxlID0gdGhpcy53aW5kb3dDb250cm9sLmhhbmRsZTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZihoYW5kbGUpIHtcbiAgICAgIC8vIFRPRE86IHZhbGlkYXRlIGBoYW5kbGVgXG4gICAgICB0aGlzLmhhbmRsZSA9IGhhbmRsZTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZihjdXN0b21pemUpIHtcbiAgICAgIGlmKCF0eXBlb2YgY3VzdG9taXplID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2BvcHRpb25zLmN1c3RvbWl6ZWAgbXVzdCBiZSBhIGZ1bmN0aW9uLicpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIGNyZWF0ZSBhIHRvcC1sZXZlbCBkaWFsb2cgb3ZlcmxheVxuICAgIHRoaXMuZGlhbG9nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGlhbG9nJyk7XG4gICAgYXBwbHlTdHlsZSh0aGlzLmRpYWxvZywge1xuICAgICAgcG9zaXRpb246ICdmaXhlZCcsXG4gICAgICB0b3A6IDAsXG4gICAgICBsZWZ0OiAwLFxuICAgICAgd2lkdGg6ICcxMDAlJyxcbiAgICAgIGhlaWdodDogJzEwMCUnLFxuICAgICAgJ21heC13aWR0aCc6ICcxMDAlJyxcbiAgICAgICdtYXgtaGVpZ2h0JzogJzEwMCUnLFxuICAgICAgZGlzcGxheTogJ25vbmUnLFxuICAgICAgbWFyZ2luOiAwLFxuICAgICAgcGFkZGluZzogMCxcbiAgICAgIGJvcmRlcjogJ25vbmUnLFxuICAgICAgYmFja2dyb3VuZDogJ3RyYW5zcGFyZW50JyxcbiAgICAgIGNvbG9yOiAnYmxhY2snLFxuICAgICAgJ2JveC1zaXppbmcnOiAnYm9yZGVyLWJveCcsXG4gICAgICBvdmVyZmxvdzogJ2hpZGRlbicsXG4gICAgICAnei1pbmRleCc6IDEwMDAwMDBcbiAgICB9KTtcbiAgICB0aGlzLmRpYWxvZy5jbGFzc05hbWUgPSAnd2ViLWFwcC13aW5kb3cnO1xuICAgIGlmKHR5cGVvZiBjbGFzc05hbWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICB0aGlzLmRpYWxvZy5jbGFzc05hbWUgPSB0aGlzLmRpYWxvZy5jbGFzc05hbWUgKyAnICcgKyBjbGFzc05hbWU7XG4gICAgfVxuXG4gICAgLy8gZW5zdXJlIGJhY2tkcm9wIGlzIHRyYW5zcGFyZW50IGJ5IGRlZmF1bHRcbiAgICBjb25zdCBzdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7XG4gICAgc3R5bGUuYXBwZW5kQ2hpbGQoXG4gICAgICBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShgZGlhbG9nLndlYi1hcHAtd2luZG93OjpiYWNrZHJvcCB7XG4gICAgICAgIGJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50O1xuICAgICAgfWApKTtcblxuICAgIC8vIGNyZWF0ZSBmbGV4IGNvbnRhaW5lciBmb3IgaWZyYW1lXG4gICAgdGhpcy5jb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBhcHBseVN0eWxlKHRoaXMuY29udGFpbmVyLCB7XG4gICAgICBwb3NpdGlvbjogJ3JlbGF0aXZlJyxcbiAgICAgIHdpZHRoOiAnMTAwJScsXG4gICAgICBoZWlnaHQ6ICcxMDAlJyxcbiAgICAgIG1hcmdpbjogMCxcbiAgICAgIHBhZGRpbmc6IDAsXG4gICAgICBkaXNwbGF5OiAnZmxleCcsXG4gICAgICAnZmxleC1kaXJlY3Rpb24nOiAnY29sdW1uJ1xuICAgIH0pO1xuICAgIHRoaXMuY29udGFpbmVyLmNsYXNzTmFtZSA9ICd3ZWItYXBwLXdpbmRvdy1iYWNrZHJvcCc7XG5cbiAgICAvLyBjcmVhdGUgaWZyYW1lXG4gICAgdGhpcy5pZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpZnJhbWUnKTtcbiAgICB0aGlzLmlmcmFtZS5zcmMgPSB1cmw7XG4gICAgdGhpcy5pZnJhbWUuc2Nyb2xsaW5nID0gJ2F1dG8nO1xuICAgIGFwcGx5U3R5bGUodGhpcy5pZnJhbWUsIHtcbiAgICAgIHBvc2l0aW9uOiAnZml4ZWQnLFxuICAgICAgdG9wOiAwLFxuICAgICAgbGVmdDogMCxcbiAgICAgIHdpZHRoOiAnMTAwJScsXG4gICAgICBoZWlnaHQ6ICcxMDAlJyxcbiAgICAgIGJvcmRlcjogJ25vbmUnLFxuICAgICAgYmFja2dyb3VuZDogJ3RyYW5zcGFyZW50JyxcbiAgICAgIG92ZXJmbG93OiAnaGlkZGVuJyxcbiAgICAgIG1hcmdpbjogMCxcbiAgICAgIHBhZGRpbmc6IDAsXG4gICAgICAnZmxleC1ncm93JzogMVxuICAgIH0pO1xuXG4gICAgLy8gYXNzZW1ibGUgZGlhbG9nXG4gICAgdGhpcy5kaWFsb2cuYXBwZW5kQ2hpbGQoc3R5bGUpO1xuICAgIHRoaXMuY29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuaWZyYW1lKTtcbiAgICB0aGlzLmRpYWxvZy5hcHBlbmRDaGlsZCh0aGlzLmNvbnRhaW5lcik7XG5cbiAgICAvLyBoYW5kbGUgY2FuY2VsICh1c2VyIHByZXNzZWQgZXNjYXBlKVxuICAgIHRoaXMuZGlhbG9nLmFkZEV2ZW50TGlzdGVuZXIoJ2NhbmNlbCcsIGUgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5oaWRlKCk7XG4gICAgfSk7XG5cbiAgICAvLyBhdHRhY2ggdG8gRE9NXG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0aGlzLmRpYWxvZyk7XG4gICAgdGhpcy5oYW5kbGUgPSB0aGlzLmlmcmFtZS5jb250ZW50V2luZG93O1xuXG4gICAgaWYoY3VzdG9taXplKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjdXN0b21pemUoe1xuICAgICAgICAgIGRpYWxvZzogdGhpcy5kaWFsb2csXG4gICAgICAgICAgY29udGFpbmVyOiB0aGlzLmNvbnRhaW5lcixcbiAgICAgICAgICBpZnJhbWU6IHRoaXMuaWZyYW1lLFxuICAgICAgICAgIHdlYkFwcFdpbmRvdzogdGhpc1xuICAgICAgICB9KTtcbiAgICAgIH0gY2F0Y2goZSkge1xuICAgICAgICBjb25zb2xlLmVycm9yKGUpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxsZWQgYnkgdGhlIGNsaWVudCB3aGVuIGl0IGlzIHJlYWR5IHRvIHJlY2VpdmUgbWVzc2FnZXMuXG4gICAqL1xuICByZWFkeSgpIHtcbiAgICB0aGlzLl9yZWFkeSA9IHRydWU7XG4gICAgdGhpcy5fcHJpdmF0ZS5fcmVzb2x2ZVJlYWR5KHRydWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGxlZCBieSB0aGUgY2xpZW50IHdoZW4gaXQgd2FudHMgdG8gc2hvdyBVSS5cbiAgICovXG4gIHNob3coKSB7XG4gICAgaWYoIXRoaXMudmlzaWJsZSkge1xuICAgICAgdGhpcy52aXNpYmxlID0gdHJ1ZTtcbiAgICAgIC8vIGRpc2FibGUgc2Nyb2xsaW5nIG9uIGJvZHlcbiAgICAgIGNvbnN0IGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5Jyk7XG4gICAgICB0aGlzLl9ib2R5T3ZlcmZsb3dTdHlsZSA9IGJvZHkuc3R5bGUub3ZlcmZsb3c7XG4gICAgICBib2R5LnN0eWxlLm92ZXJmbG93ID0gJ2hpZGRlbic7XG4gICAgICBpZih0aGlzLmRpYWxvZykge1xuICAgICAgICB0aGlzLmRpYWxvZy5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgaWYodGhpcy5kaWFsb2cuc2hvd01vZGFsKSB7XG4gICAgICAgICAgdGhpcy5kaWFsb2cuc2hvd01vZGFsKCk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZih0aGlzLndpbmRvd0NvbnRyb2wuc2hvdykge1xuICAgICAgICB0aGlzLndpbmRvd0NvbnRyb2wuc2hvdygpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxsZWQgYnkgdGhlIGNsaWVudCB3aGVuIGl0IHdhbnRzIHRvIGhpZGUgVUkuXG4gICAqL1xuICBoaWRlKCkge1xuICAgIGlmKHRoaXMudmlzaWJsZSkge1xuICAgICAgdGhpcy52aXNpYmxlID0gZmFsc2U7XG4gICAgICAvLyByZXN0b3JlIGBvdmVyZmxvd2Agc3R5bGUgb24gYm9keVxuICAgICAgY29uc3QgYm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKTtcbiAgICAgIGlmKHRoaXMuX2JvZHlPdmVyZmxvd1N0eWxlKSB7XG4gICAgICAgIGJvZHkuc3R5bGUub3ZlcmZsb3cgPSB0aGlzLl9ib2R5T3ZlcmZsb3dTdHlsZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGJvZHkuc3R5bGUub3ZlcmZsb3cgPSAnJztcbiAgICAgIH1cbiAgICAgIGlmKHRoaXMuZGlhbG9nKSB7XG4gICAgICAgIHRoaXMuZGlhbG9nLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgIGlmKHRoaXMuZGlhbG9nLmNsb3NlKSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMuZGlhbG9nLmNsb3NlKCk7XG4gICAgICAgICAgfSBjYXRjaChlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmKHRoaXMud2luZG93Q29udHJvbC5oaWRlKSB7XG4gICAgICAgIHRoaXMud2luZG93Q29udHJvbC5oaWRlKCk7XG4gICAgICB9XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIGFwcGx5U3R5bGUoZWxlbWVudCwgc3R5bGUpIHtcbiAgZm9yKGNvbnN0IG5hbWUgaW4gc3R5bGUpIHtcbiAgICBlbGVtZW50LnN0eWxlW25hbWVdID0gc3R5bGVbbmFtZV07XG4gIH1cbn1cbiIsIi8qIVxuICogQ29weXJpZ2h0IChjKSAyMDE3IERpZ2l0YWwgQmF6YWFyLCBJbmMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKi9cbid1c2Ugc3RyaWN0JztcblxuaW1wb3J0IHtDbGllbnR9IGZyb20gJy4vQ2xpZW50LmpzJztcbmltcG9ydCB7U2VydmVyfSBmcm9tICcuL1NlcnZlci5qcyc7XG5pbXBvcnQge1dlYkFwcFdpbmRvd30gZnJvbSAnLi9XZWJBcHBXaW5kb3cuanMnO1xuaW1wb3J0IHtwYXJzZVVybH0gZnJvbSAnLi91dGlscy5qcyc7XG5cbi8vIDEwIHNlY29uZHNcbmNvbnN0IFdFQl9BUFBfQ09OVEVYVF9MT0FEX1RJTUVPVVQgPSAxMDAwMDtcblxuZXhwb3J0IGNsYXNzIFdlYkFwcENvbnRleHQge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmNsaWVudCA9IG5ldyBDbGllbnQoKTtcbiAgICB0aGlzLnNlcnZlciA9IG5ldyBTZXJ2ZXIoKTtcbiAgICB0aGlzLmluamVjdG9yID0gbnVsbDtcbiAgICB0aGlzLmNvbnRyb2wgPSBudWxsO1xuICAgIHRoaXMubG9hZGVkID0gZmFsc2U7XG4gICAgdGhpcy5jbG9zZWQgPSBmYWxzZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGEgd2luZG93IChvciBhdHRhY2hlcyB0byBhbiBleGlzdGluZyBvbmUpIHRoYXQgbG9hZHMgYSBwYWdlIHRoYXRcbiAgICogaXMgZXhwZWN0ZWQgdG8gdW5kZXJzdGFuZCB0aGUgd2ViIHJlcXVlc3QgUlBDIHByb3RvY29sLiBUaGlzIG1ldGhvZFxuICAgKiByZXR1cm5zIGEgUHJvbWlzZSB0aGF0IHdpbGwgcmVzb2x2ZSBvbmNlIHRoZSBwYWdlIHVzZXMgUlBDIHRvIGluZGljYXRlXG4gICAqIHRoYXQgaXQgaXMgcmVhZHkgdG8gYmUgY29tbXVuaWNhdGVkIHdpdGggb3Igb25jZSBhIHRpbWVvdXQgb2NjdXJzLlxuICAgKlxuICAgKiBUaGUgUHJvbWlzZSB3aWxsIHJlc29sdmUgdG8gYW4gUlBDIGluamVjdG9yIHRoYXQgY2FuIGJlIHVzZWQgdG8gZ2V0IG9yXG4gICAqIGRlZmluZSBBUElzIHRvIGVuYWJsZSBjb21tdW5pY2F0aW9uIHdpdGggdGhlIFdlYkFwcCBydW5uaW5nIGluIHRoZVxuICAgKiBXZWJBcHBDb250ZXh0LlxuICAgKlxuICAgKiBAcGFyYW0gdXJsIHRoZSBVUkwgdG8gdGhlIHBhZ2UgdG8gY29ubmVjdCB0by5cbiAgICogQHBhcmFtIG9wdGlvbnMgdGhlIG9wdGlvbnMgdG8gdXNlOlxuICAgKiAgICAgICAgICBbdGltZW91dF0gdGhlIHRpbWVvdXQgZm9yIHdhaXRpbmcgZm9yIHRoZSBjbGllbnQgdG8gYmUgcmVhZHkuXG4gICAqICAgICAgICAgIFtoYW5kbGVdIGEgd2luZG93IGhhbmRsZSB0byBjb25uZWN0IHRvOyBtYXkgYmUgYSBQcm9taXNlIHRoYXRcbiAgICogICAgICAgICAgICB0aGF0IHJlc29sdmVzIHRvIGEgaGFuZGxlLlxuICAgKiAgICAgICAgICBbaWZyYW1lXSBhbiBpZnJhbWUgZWxlbWVudCB0byBjb25uZWN0IHRvLlxuICAgKiAgICAgICAgICBbd2luZG93Q29udHJvbF0gYSB3aW5kb3cgY29udHJvbCBpbnRlcmZhY2UgdG8gY29ubmVjdCB0by5cbiAgICogICAgICAgICAgW2NsYXNzTmFtZV0gYSBjbGFzc05hbWUgdG8gYXNzaWduIHRvIHRoZSB3aW5kb3cgZm9yIENTUyBwdXJwb3Nlcy5cbiAgICogICAgICAgICAgW2N1c3RvbWl6ZShvcHRpb25zKV0gYSBmdW5jdGlvbiB0byBjdXN0b21pemUgdGhlIGRpYWxvZyB0aGF0XG4gICAqICAgICAgICAgICAgbG9hZHMgdGhlIHdpbmRvdyBhZnRlciBpdHMgY29uc3RydWN0aW9uLlxuICAgKlxuICAgKiBAcmV0dXJuIGEgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHRvIGFuIFJQQyBpbmplY3RvciBvbmNlIHRoZSB3aW5kb3cgaXNcbiAgICogICAgICAgICAgIHJlYWR5LlxuICAgKi9cbiAgYXN5bmMgY3JlYXRlV2luZG93KFxuICAgIHVybCwge1xuICAgICAgdGltZW91dCA9IFdFQl9BUFBfQ09OVEVYVF9MT0FEX1RJTUVPVVQsXG4gICAgICBpZnJhbWUsXG4gICAgICBoYW5kbGUsXG4gICAgICB3aW5kb3dDb250cm9sLFxuICAgICAgY2xhc3NOYW1lLFxuICAgICAgY3VzdG9taXplXG4gICAgfSA9IHt9KSB7XG4gICAgLy8gZGlzYWxsb3cgbG9hZGluZyB0aGUgc2FtZSBXZWJBcHBDb250ZXh0IG1vcmUgdGhhbiBvbmNlXG4gICAgaWYodGhpcy5sb2FkZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQXBwQ29udGV4dCBhbHJlYWR5IGxvYWRlZC4nKTtcbiAgICB9XG4gICAgdGhpcy5sb2FkZWQgPSB0cnVlO1xuXG4gICAgLy8gY3JlYXRlIGNvbnRyb2wgQVBJIGZvciBXZWJBcHAgdG8gY2FsbCB2aWEgaXRzIG93biBSUEMgY2xpZW50XG4gICAgdGhpcy5jb250cm9sID0gbmV3IFdlYkFwcFdpbmRvdyh1cmwsIHtcbiAgICAgIHRpbWVvdXQsXG4gICAgICBpZnJhbWUsXG4gICAgICBoYW5kbGUsXG4gICAgICB3aW5kb3dDb250cm9sLFxuICAgICAgY2xhc3NOYW1lLFxuICAgICAgY3VzdG9taXplXG4gICAgfSk7XG5cbiAgICAvLyBkZWZpbmUgY29udHJvbCBjbGFzczsgdGhpcyBlbmFibGVzIHRoZSBXZWJBcHAgdGhhdCBpcyBydW5uaW5nIGluIHRoZVxuICAgIC8vIFdlYkFwcENvbnRleHQgdG8gY29udHJvbCBpdHMgVUkgb3IgY2xvc2UgaXRzZWxmIGRvd25cbiAgICB0aGlzLnNlcnZlci5kZWZpbmUoJ2NvcmUuY29udHJvbCcsIHRoaXMuY29udHJvbCk7XG5cbiAgICAvLyBsaXN0ZW4gZm9yIGNhbGxzIGZyb20gdGhlIHdpbmRvdywgaWdub3JpbmcgY2FsbHMgdG8gdW5rbm93biBBUElzXG4gICAgLy8gdG8gYWxsb3cgdGhvc2UgdG8gYmUgaGFuZGxlZCBieSBvdGhlciBzZXJ2ZXJzXG4gICAgY29uc3Qgb3JpZ2luID0gcGFyc2VVcmwodXJsKS5vcmlnaW47XG4gICAgdGhpcy5zZXJ2ZXIubGlzdGVuKG9yaWdpbiwge1xuICAgICAgaGFuZGxlOiB0aGlzLmNvbnRyb2wuaGFuZGxlLFxuICAgICAgaWdub3JlVW5rbm93bkFwaTogdHJ1ZVxuICAgIH0pO1xuXG4gICAgLy8gd2FpdCBmb3IgY29udHJvbCB0byBiZSByZWFkeVxuICAgIGF3YWl0IHRoaXMuY29udHJvbC5fcHJpdmF0ZS5pc1JlYWR5KCk7XG5cbiAgICAvLyBjb25uZWN0IHRvIHRoZSBXZWJBcHBDb250ZXh0IGFuZCByZXR1cm4gdGhlIGluamVjdG9yXG4gICAgdGhpcy5pbmplY3RvciA9IGF3YWl0IHRoaXMuY2xpZW50LmNvbm5lY3Qob3JpZ2luLCB7XG4gICAgICBoYW5kbGU6IHRoaXMuY29udHJvbC5oYW5kbGVcbiAgICB9KTtcbiAgICByZXR1cm4gdGhpcy5pbmplY3RvcjtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIGlmKCF0aGlzLmNsb3NlZCkge1xuICAgICAgdGhpcy5jbG9zZWQgPSB0cnVlO1xuICAgICAgdGhpcy5jb250cm9sLl9wcml2YXRlLmRlc3Ryb3koKTtcbiAgICAgIHRoaXMuc2VydmVyLmNsb3NlKCk7XG4gICAgICB0aGlzLmNsaWVudC5jbG9zZSgpO1xuICAgIH1cbiAgfVxufVxuIiwiLyohXG4gKiBBIENyZWRlbnRpYWxSZXF1ZXN0RXZlbnQgaXMgZW1pdHRlZCB3aGVuIGEgcmVxdWVzdCBoYXMgYmVlbiBtYWRlIGZvclxuICogY3JlZGVudGlhbHMuXG4gKlxuICogQ29weXJpZ2h0IChjKSAyMDE3IERpZ2l0YWwgQmF6YWFyLCBJbmMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKi9cbi8qIGdsb2JhbCBFdmVudCAqL1xuJ3VzZSBzdHJpY3QnO1xuXG5pbXBvcnQgKiBhcyBycGMgZnJvbSAnd2ViLXJlcXVlc3QtcnBjJztcblxuLy8gY2FuJ3QgdXNlIFwiRXh0ZW5kYWJsZUV2ZW50XCI7IG9ubHkgYWNjZXNzaWJsZSBmcm9tIFdvcmtlcnNcbi8vIFRPRE86IG1heSBub3QgYmUgYWJsZSB0byBldmVuIGV4dGVuZCBgRXZlbnRgIGhlcmU7IGNvdWxkIHByb2R1Y2UgXCJpbmNvcnJlY3RcIlxuLy8gICBjb3JlIGF0dHJpYnV0ZXNcbmV4cG9ydCBjbGFzcyBDcmVkZW50aWFsUmVxdWVzdEV2ZW50IC8qZXh0ZW5kcyBFdmVudCovIHtcbiAgY29uc3RydWN0b3Ioe1xuICAgIGNyZWRlbnRpYWxIYW5kbGVyLFxuICAgIGNyZWRlbnRpYWxSZXF1ZXN0T3JpZ2luLFxuICAgIGNyZWRlbnRpYWxSZXF1ZXN0T3B0aW9ucyxcbiAgICBoaW50S2V5XG4gIH0pIHtcbiAgICAvL3N1cGVyKCdjcmVkZW50aWFscmVxdWVzdCcpO1xuICAgIHRoaXMudHlwZSA9ICdjcmVkZW50aWFscmVxdWVzdCc7XG4gICAgdGhpcy5fY3JlZGVudGlhbEhhbmRsZXIgPSBjcmVkZW50aWFsSGFuZGxlcjtcbiAgICB0aGlzLmNyZWRlbnRpYWxSZXF1ZXN0T3JpZ2luID0gY3JlZGVudGlhbFJlcXVlc3RPcmlnaW47XG4gICAgdGhpcy5jcmVkZW50aWFsUmVxdWVzdE9wdGlvbnMgPSBjcmVkZW50aWFsUmVxdWVzdE9wdGlvbnM7XG4gICAgdGhpcy5oaW50S2V5ID0gaGludEtleTtcbiAgfVxuXG4gIGFzeW5jIG9wZW5XaW5kb3codXJsKSB7XG4gICAgLy8gVE9ETzogZGlzYWxsb3cgbW9yZSB0aGFuIG9uZSBjYWxsXG5cbiAgICAvLyBUT0RPOiBlbnN1cmUgYHVybGAgaXMgdG8gdGhlIHNhbWUgb3JpZ2luXG4gICAgYXdhaXQgdGhpcy5fY3JlZGVudGlhbEhhbmRsZXIuc2hvdygpO1xuICAgIGNvbnN0IGFwcFdpbmRvdyA9IG5ldyBycGMuV2ViQXBwV2luZG93KHVybCwge1xuICAgICAgY2xhc3NOYW1lOiAnY3JlZGVudGlhbC1oYW5kbGVyJ1xuICAgIH0pO1xuICAgIGFwcFdpbmRvdy5yZWFkeSgpO1xuICAgIGFwcFdpbmRvdy5zaG93KCk7XG4gICAgLy8gVE9ETzogbm90ZSB0aGF0IGBhcHBXaW5kb3cuaGFuZGxlYCBpcyBub3QgYSBTZXJ2aWNlV29ya2VyXG4gICAgLy8gICBgV2luZG93Q2xpZW50YCBwb2x5ZmlsbC4uLiBjb3VsZCBiZSBjb25mdXNpbmcgaGVyZSwgc2hvdWxkIHdlXG4gICAgLy8gICBpbXBsZW1lbnQgb25lIHRvIHdyYXAgaXQ/IC0tIHRoZXJlIGlzLCBmb3IgZXhhbXBsZSwgYVxuICAgIC8vICAgYG5hdmlnYXRlYCBjYWxsIG9uIGBXaW5kb3dDbGllbnRgIHRoYXQgZW5mb3JjZXMgc2FtZSBvcmlnaW4sIHdvdWxkXG4gICAgLy8gICBuZWVkIHRvIGF0dGVtcHQgdG8gYWRkIG9yIGFwcHJveGltYXRlIHRoYXRcbiAgICByZXR1cm4gYXBwV2luZG93LmhhbmRsZTtcbiAgfVxuXG4gIHJlc3BvbmRXaXRoKGhhbmRsZXJSZXNwb25zZSkge1xuICAgIC8vIFRPRE86IHRocm93IGV4Y2VwdGlvbiBpZiBgX3Byb21pc2VgIGlzIGFscmVhZHkgc2V0XG5cbiAgICAvLyBUT0RPOiB2YWxpZGF0ZSBoYW5kbGVyUmVzcG9uc2VcbiAgICB0aGlzLl9wcm9taXNlID0gaGFuZGxlclJlc3BvbnNlO1xuICB9XG59XG4iLCIvKiFcbiAqIEEgQ3JlZGVudGlhbFN0b3JlRXZlbnQgaXMgZW1pdHRlZCB3aGVuIGEgcmVxdWVzdCBoYXMgYmVlbiBtYWRlIHRvXG4gKiBzdG9yZSBhIGNyZWRlbnRpYWwuXG4gKlxuICogQ29weXJpZ2h0IChjKSAyMDE3IERpZ2l0YWwgQmF6YWFyLCBJbmMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKi9cbi8qIGdsb2JhbCBFdmVudCAqL1xuJ3VzZSBzdHJpY3QnO1xuXG5pbXBvcnQgKiBhcyBycGMgZnJvbSAnd2ViLXJlcXVlc3QtcnBjJztcblxuLy8gY2FuJ3QgdXNlIFwiRXh0ZW5kYWJsZUV2ZW50XCI7IG9ubHkgYWNjZXNzaWJsZSBmcm9tIFdvcmtlcnNcbi8vIFRPRE86IG1heSBub3QgYmUgYWJsZSB0byBldmVuIGV4dGVuZCBgRXZlbnRgIGhlcmU7IGNvdWxkIHByb2R1Y2UgXCJpbmNvcnJlY3RcIlxuLy8gICBjb3JlIGF0dHJpYnV0ZXNcbmV4cG9ydCBjbGFzcyBDcmVkZW50aWFsU3RvcmVFdmVudCAvKmV4dGVuZHMgRXZlbnQqLyB7XG4gIGNvbnN0cnVjdG9yKHtcbiAgICBjcmVkZW50aWFsSGFuZGxlcixcbiAgICBjcmVkZW50aWFsUmVxdWVzdE9yaWdpbixcbiAgICBjcmVkZW50aWFsLFxuICAgIGhpbnRLZXlcbiAgfSkge1xuICAgIC8vc3VwZXIoJ2NyZWRlbnRpYWxzdG9yZScpO1xuICAgIHRoaXMudHlwZSA9ICdjcmVkZW50aWFsc3RvcmUnO1xuICAgIHRoaXMuX2NyZWRlbnRpYWxIYW5kbGVyID0gY3JlZGVudGlhbEhhbmRsZXI7XG4gICAgdGhpcy5jcmVkZW50aWFsUmVxdWVzdE9yaWdpbiA9IGNyZWRlbnRpYWxSZXF1ZXN0T3JpZ2luO1xuICAgIHRoaXMuY3JlZGVudGlhbCA9IGNyZWRlbnRpYWw7XG4gICAgdGhpcy5oaW50S2V5ID0gaGludEtleTtcbiAgfVxuXG4gIGFzeW5jIG9wZW5XaW5kb3codXJsKSB7XG4gICAgLy8gVE9ETzogZGlzYWxsb3cgbW9yZSB0aGFuIG9uZSBjYWxsXG5cbiAgICAvLyBUT0RPOiBlbnN1cmUgYHVybGAgaXMgdG8gdGhlIHNhbWUgb3JpZ2luXG4gICAgYXdhaXQgdGhpcy5fY3JlZGVudGlhbEhhbmRsZXIuc2hvdygpO1xuICAgIGNvbnN0IGFwcFdpbmRvdyA9IG5ldyBycGMuV2ViQXBwV2luZG93KHVybCk7XG4gICAgYXBwV2luZG93LnJlYWR5KCk7XG4gICAgYXBwV2luZG93LnNob3coKTtcbiAgICAvLyBUT0RPOiBub3RlIHRoYXQgYGFwcFdpbmRvdy5oYW5kbGVgIGlzIG5vdCBhIFNlcnZpY2VXb3JrZXJcbiAgICAvLyAgIGBXaW5kb3dDbGllbnRgIHBvbHlmaWxsLi4uIGNvdWxkIGJlIGNvbmZ1c2luZyBoZXJlLCBzaG91bGQgd2VcbiAgICAvLyAgIGltcGxlbWVudCBvbmUgdG8gd3JhcCBpdD8gLS0gdGhlcmUgaXMsIGZvciBleGFtcGxlLCBhXG4gICAgLy8gICBgbmF2aWdhdGVgIGNhbGwgb24gYFdpbmRvd0NsaWVudGAgdGhhdCBlbmZvcmNlcyBzYW1lIG9yaWdpbiwgd291bGRcbiAgICAvLyAgIG5lZWQgdG8gYXR0ZW1wdCB0byBhZGQgb3IgYXBwcm94aW1hdGUgdGhhdFxuICAgIHJldHVybiBhcHBXaW5kb3cuaGFuZGxlO1xuICB9XG5cbiAgcmVzcG9uZFdpdGgoaGFuZGxlclJlc3BvbnNlKSB7XG4gICAgLy8gVE9ETzogdGhyb3cgZXhjZXB0aW9uIGlmIGBfcHJvbWlzZWAgaXMgYWxyZWFkeSBzZXRcblxuICAgIC8vIFRPRE86IHZhbGlkYXRlIGhhbmRsZXJSZXNwb25zZVxuICAgIHRoaXMuX3Byb21pc2UgPSBoYW5kbGVyUmVzcG9uc2U7XG4gIH1cbn1cbiIsIi8qIVxuICogQSBDcmVkZW50aWFsSGFuZGxlclNlcnZpY2UgaGFuZGxlcyByZW1vdGUgY2FsbHMgdG8gYSBDcmVkZW50aWFsSGFuZGxlci5cbiAqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTcgRGlnaXRhbCBCYXphYXIsIEluYy4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqL1xuJ3VzZSBzdHJpY3QnO1xuXG5pbXBvcnQge0NyZWRlbnRpYWxSZXF1ZXN0RXZlbnR9IGZyb20gJy4vQ3JlZGVudGlhbFJlcXVlc3RFdmVudC5qcyc7XG5pbXBvcnQge0NyZWRlbnRpYWxTdG9yZUV2ZW50fSBmcm9tICcuL0NyZWRlbnRpYWxTdG9yZUV2ZW50LmpzJztcblxuZXhwb3J0IGNsYXNzIENyZWRlbnRpYWxIYW5kbGVyU2VydmljZSB7XG4gIGNvbnN0cnVjdG9yKGNyZWRlbnRpYWxIYW5kbGVyKSB7XG4gICAgdGhpcy5fY3JlZGVudGlhbEhhbmRsZXIgPSBjcmVkZW50aWFsSGFuZGxlcjtcbiAgfVxuXG4gIGFzeW5jIHJlcXVlc3QoY3JlZGVudGlhbFJlcXVlc3RFdmVudCkge1xuICAgIC8vIFRPRE86IHZhbGlkYXRlIGNyZWRlbnRpYWxSZXF1ZXN0RXZlbnRcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5fY3JlZGVudGlhbEhhbmRsZXIuX2VtaXR0ZXIuZW1pdChcbiAgICAgIG5ldyBDcmVkZW50aWFsUmVxdWVzdEV2ZW50KE9iamVjdC5hc3NpZ24oXG4gICAgICAgIHtjcmVkZW50aWFsSGFuZGxlcjogdGhpcy5fY3JlZGVudGlhbEhhbmRsZXJ9LCBjcmVkZW50aWFsUmVxdWVzdEV2ZW50KSkpO1xuICB9XG5cbiAgYXN5bmMgc3RvcmUoY3JlZGVudGlhbFN0b3JlRXZlbnQpIHtcbiAgICAvLyBUT0RPOiB2YWxpZGF0ZSBjcmVkZW50aWFsU3RvcmVFdmVudFxuICAgIHJldHVybiBhd2FpdCB0aGlzLl9jcmVkZW50aWFsSGFuZGxlci5fZW1pdHRlci5lbWl0KFxuICAgICAgbmV3IENyZWRlbnRpYWxTdG9yZUV2ZW50KE9iamVjdC5hc3NpZ24oXG4gICAgICAgIHtjcmVkZW50aWFsSGFuZGxlcjogdGhpcy5fY3JlZGVudGlhbEhhbmRsZXJ9LCBjcmVkZW50aWFsU3RvcmVFdmVudCkpKTtcbiAgfVxufVxuIiwiLyohXG4gKiBUaGUgY29yZSBDcmVkZW50aWFsSGFuZGxlciBjbGFzcy5cbiAqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTcgRGlnaXRhbCBCYXphYXIsIEluYy4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqL1xuLyogZ2xvYmFsIERPTUV4Y2VwdGlvbiAqL1xuJ3VzZSBzdHJpY3QnO1xuXG5pbXBvcnQgKiBhcyBycGMgZnJvbSAnd2ViLXJlcXVlc3QtcnBjJztcblxuaW1wb3J0IHtDcmVkZW50aWFsSGFuZGxlclNlcnZpY2V9IGZyb20gJy4vQ3JlZGVudGlhbEhhbmRsZXJTZXJ2aWNlLmpzJztcblxuY29uc3QgRVZFTlRfVFlQRVMgPSBbJ2NyZWRlbnRpYWxyZXF1ZXN0JywgJ2NyZWRlbnRpYWxzdG9yZSddO1xuXG5leHBvcnQgY2xhc3MgQ3JlZGVudGlhbEhhbmRsZXIgZXh0ZW5kcyBycGMuV2ViQXBwIHtcbiAgY29uc3RydWN0b3IobWVkaWF0b3JPcmlnaW4pIHtcbiAgICBpZih0eXBlb2YgbWVkaWF0b3JPcmlnaW4gIT09ICdzdHJpbmcnKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdcIm1lZGlhdG9yT3JpZ2luXCIgbXVzdCBiZSBhIHN0cmluZy4nKTtcbiAgICB9XG4gICAgc3VwZXIobWVkaWF0b3JPcmlnaW4pO1xuICAgIHRoaXMuX2VtaXR0ZXIgPSBuZXcgcnBjLkV2ZW50RW1pdHRlcih7XG4gICAgICBhc3luYyB3YWl0VW50aWwoZXZlbnQpIHtcbiAgICAgICAgLy8gVE9ETzogbWF5IG5lZWQgdG8gZG8gYHRoaXMuaGlkZSgpYCBhZnRlciB0aGlzIHByb21pc2UgcmVzb2x2ZXNcbiAgICAgICAgLy8gICB0byBoYW5kbGUgY2FzZSB3aGVyZSBlLm9wZW5XaW5kb3coKSB3YXMgY2FsbGVkXG4gICAgICAgIHJldHVybiBldmVudC5fcHJvbWlzZSB8fCBQcm9taXNlLnJlamVjdChcbiAgICAgICAgICBuZXcgRE9NRXhjZXB0aW9uKFxuICAgICAgICAgICAgJ05vIFwiY3JlZGVudGlhbHJlcXVlc3RcIiBldmVudCBoYW5kbGVyIGZvdW5kLicsICdOb3RGb3VuZEVycm9yJykpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgY29ubmVjdCgpIHtcbiAgICBjb25zdCBpbmplY3RvciA9IGF3YWl0IHN1cGVyLmNvbm5lY3QoKTtcblxuICAgIC8vIGRlZmluZSBBUEkgdGhhdCBDcmVkZW50aWFsTWVkaWF0b3IgY2FuIGNhbGwgb24gdGhpcyBjcmVkZW50aWFsIGhhbmRsZXJcbiAgICB0aGlzLnNlcnZlci5kZWZpbmUoJ2NyZWRlbnRpYWxIYW5kbGVyJywgbmV3IENyZWRlbnRpYWxIYW5kbGVyU2VydmljZSh0aGlzKSk7XG5cbiAgICAvLyBhdXRvLWNhbGwgYHJlYWR5YFxuICAgIGF3YWl0IHRoaXMucmVhZHkoKTtcblxuICAgIHJldHVybiBpbmplY3RvcjtcbiAgfVxuXG4gIGFkZEV2ZW50TGlzdGVuZXIoZXZlbnRUeXBlLCBmbikge1xuICAgIGlmKCFFVkVOVF9UWVBFUy5pbmNsdWRlcyhldmVudFR5cGUpKSB7XG4gICAgICB0aHJvdyBuZXcgRE9NRXhjZXB0aW9uKFxuICAgICAgICBgVW5zdXBwb3J0ZWQgZXZlbnQgdHlwZSBcIiR7ZXZlbnRUeXBlfVwiYCwgJ05vdFN1cHBvcnRlZEVycm9yJyk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLl9lbWl0dGVyLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnRUeXBlLCBmbik7XG4gIH1cblxuICByZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50VHlwZSwgZm4pIHtcbiAgICBpZighRVZFTlRfVFlQRVMuaW5jbHVkZXMoZXZlbnRUeXBlKSkge1xuICAgICAgdGhyb3cgbmV3IERPTUV4Y2VwdGlvbihcbiAgICAgICAgYFVuc3VwcG9ydGVkIGV2ZW50IHR5cGUgXCIke2V2ZW50VHlwZX1cImAsICdOb3RTdXBwb3J0ZWRFcnJvcicpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5fZW1pdHRlci5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50VHlwZSwgZm4pO1xuICB9XG59XG4iLCIvKiFcbiAqIEFQSSBmb3IgbWFuYWdpbmcgQ3JlZGVudGlhbEhpbnRzLlxuICpcbiAqIENvcHlyaWdodCAoYykgMjAxNyBEaWdpdGFsIEJhemFhciwgSW5jLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICovXG4vKiBnbG9iYWwgSW1hZ2UgKi9cbid1c2Ugc3RyaWN0JztcblxuZXhwb3J0IGNsYXNzIENyZWRlbnRpYWxIaW50cyB7XG4gIGNvbnN0cnVjdG9yKHVybCwgaW5qZWN0b3IpIHtcbiAgICBjb25zdCByZW1vdGUgPSBpbmplY3Rvci5nZXQoJ2NyZWRlbnRpYWxIaW50cycsIHtcbiAgICAgIGZ1bmN0aW9uczogWydkZWxldGUnLCAnZ2V0JywgJ2tleXMnLCAnaGFzJywgJ3NldCcsICdjbGVhciddXG4gICAgfSk7XG4gICAgZm9yKGxldCBtZXRob2ROYW1lIGluIHJlbW90ZSkge1xuICAgICAgaWYobWV0aG9kTmFtZSAhPT0gJ3NldCcpIHtcbiAgICAgICAgdGhpc1ttZXRob2ROYW1lXSA9IHJlbW90ZVttZXRob2ROYW1lXS5iaW5kKHRoaXMsIHVybCk7XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMuX3JlbW90ZVNldCA9IHJlbW90ZS5zZXQuYmluZCh0aGlzLCB1cmwpO1xuICB9XG5cbiAgYXN5bmMgc2V0KGhpbnRLZXksIGNyZWRlbnRpYWxIaW50KSB7XG4gICAgLy8gVE9ETzogdmFsaWRhdGUgY3JlZGVudGlhbCBoaW50XG5cbiAgICAvLyBlbnN1cmUgaW1hZ2VzIGFyZSBwcmVmZXRjaGVkIHNvIHRoYXQgdGhleSB3aWxsIG5vdCBsZWFrIGluZm9ybWF0aW9uXG4gICAgLy8gd2hlbiBmZXRjaGVkIGxhdGVyXG4gICAgY3JlZGVudGlhbEhpbnQuaWNvbnMgPSBjcmVkZW50aWFsSGludC5pY29ucyB8fCBbXTtcbiAgICBjb25zdCBwcm9taXNlcyA9IGNyZWRlbnRpYWxIaW50Lmljb25zLm1hcChpY29uID0+XG4gICAgICBpbWFnZVRvRGF0YVVybChpY29uLnNyYykudGhlbihmZXRjaGVkSW1hZ2UgPT4ge1xuICAgICAgICBpY29uLmZldGNoZWRJbWFnZSA9IGZldGNoZWRJbWFnZTtcbiAgICAgIH0pKTtcbiAgICBhd2FpdCBQcm9taXNlLmFsbChwcm9taXNlcyk7XG4gICAgcmV0dXJuIHRoaXMuX3JlbW90ZVNldChoaW50S2V5LCBjcmVkZW50aWFsSGludCk7XG4gIH1cbn1cblxuZnVuY3Rpb24gaW1hZ2VUb0RhdGFVcmwodXJsKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICBjb25zdCBpbWcgPSBuZXcgSW1hZ2UoKTtcbiAgICBpbWcuY3Jvc3NPcmlnaW4gPSAnQW5vbnltb3VzJztcbiAgICBpbWcub25sb2FkID0gKCkgPT4ge1xuICAgICAgbGV0IGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuICAgICAgY29uc3QgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7XG4gICAgICBjYW52YXMuaGVpZ2h0ID0gaW1nLmhlaWdodDtcbiAgICAgIGNhbnZhcy53aWR0aCA9IGltZy53aWR0aDtcbiAgICAgIGN0eC5kcmF3SW1hZ2UoaW1nLCAwLCAwKTtcbiAgICAgIGNvbnN0IGRhdGFVcmwgPSBjYW52YXMudG9EYXRhVVJMKCk7XG4gICAgICByZXNvbHZlKGRhdGFVcmwpO1xuICAgICAgY2FudmFzID0gbnVsbDtcbiAgICB9O1xuICAgIC8vIFRPRE86IGByZWplY3RgIGFzIGFuIGVycm9yIGFuZCBmYWlsIGAuc2V0YD9cbiAgICBpbWcub25lcnJvciA9ICgpID0+IHJlc29sdmUobnVsbCk7XG4gICAgaW1nLnNyYyA9IHVybDtcbiAgfSk7XG59XG4iLCIvKiFcbiAqIEEgQ3JlZGVudGlhbE1hbmFnZXIgZm9yIGEgV2ViIENyZWRlbnRpYWwgTWVkaWF0b3IuXG4gKlxuICogQ29weXJpZ2h0IChjKSAyMDE3LTIwMTggRGlnaXRhbCBCYXphYXIsIEluYy4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqL1xuLyogZ2xvYmFsIG5hdmlnYXRvciAqL1xuJ3VzZSBzdHJpY3QnO1xuXG5pbXBvcnQge0NyZWRlbnRpYWxIaW50c30gZnJvbSAnLi9DcmVkZW50aWFsSGludHMuanMnO1xuXG5leHBvcnQgY2xhc3MgQ3JlZGVudGlhbE1hbmFnZXIge1xuICBjb25zdHJ1Y3Rvcih1cmwsIGluamVjdG9yKSB7XG4gICAgaWYoISh1cmwgJiYgdHlwZW9mIHVybCA9PT0gJ3N0cmluZycpKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdcInVybFwiIG11c3QgYmUgYSBub24tZW1wdHkgc3RyaW5nLicpO1xuICAgIH1cbiAgICB0aGlzLmhpbnRzID0gbmV3IENyZWRlbnRpYWxIaW50cyh1cmwsIGluamVjdG9yKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXF1ZXN0cyB0aGF0IHRoZSB1c2VyIGdyYW50ICdjcmVkZW50aWFsaGFuZGxlcicgcGVybWlzc2lvbiB0byB0aGUgY3VycmVudFxuICAgKiBvcmlnaW4uXG4gICAqXG4gICAqIEByZXR1cm4gYSBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIG5ldyBQZXJtaXNzaW9uU3RhdGUgb2YgdGhlXG4gICAqICAgICAgICAgICBwZXJtaXNzaW9uIChlLmcuICdncmFudGVkJy8nZGVuaWVkJykuXG4gICAqL1xuICBzdGF0aWMgYXN5bmMgcmVxdWVzdFBlcm1pc3Npb24oKSB7XG4gICAgY29uc3Qgc3RhdHVzID0gYXdhaXQgbmF2aWdhdG9yLmNyZWRlbnRpYWxzUG9seWZpbGwucGVybWlzc2lvbnMucmVxdWVzdChcbiAgICAgIHtuYW1lOiAnY3JlZGVudGlhbGhhbmRsZXInfSk7XG4gICAgcmV0dXJuIHN0YXR1cy5zdGF0ZTtcbiAgfVxufVxuIiwiLyohXG4gKiBBIENyZWRlbnRpYWxIYW5kbGVyUmVnaXN0cmF0aW9uIHByb3ZpZGVzIGEgQ3JlZGVudGlhbE1hbmFnZXIgdG8gZW5hYmxlIFdlYlxuICogYXBwcyB0byByZWdpc3RlciBQcm9maWxlcyB0aGF0IGNhbiBiZSBwcmVzZW50ZWQgdG8gd2Vic2l0ZXMuXG4gKlxuICogQ29weXJpZ2h0IChjKSAyMDE3IERpZ2l0YWwgQmF6YWFyLCBJbmMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKi9cbid1c2Ugc3RyaWN0JztcblxuaW1wb3J0IHtDcmVkZW50aWFsTWFuYWdlcn0gZnJvbSAnLi9DcmVkZW50aWFsTWFuYWdlci5qcyc7XG5cbmV4cG9ydCBjbGFzcyBDcmVkZW50aWFsSGFuZGxlclJlZ2lzdHJhdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHVybCwgaW5qZWN0b3IpIHtcbiAgICBpZighKHVybCAmJiB0eXBlb2YgdXJsID09PSAnc3RyaW5nJykpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1widXJsXCIgbXVzdCBiZSBhIG5vbi1lbXB0eSBzdHJpbmcuJyk7XG4gICAgfVxuICAgIHRoaXMuY3JlZGVudGlhbE1hbmFnZXIgPSBuZXcgQ3JlZGVudGlhbE1hbmFnZXIodXJsLCBpbmplY3Rvcik7XG4gIH1cbn1cbiIsIi8qIVxuICogUHJvdmlkZXMgYW4gQVBJIGZvciB3b3JraW5nIHdpdGggQ3JlZGVudGlhbEhhbmRsZXJSZWdpc3RyYXRpb25zLlxuICpcbiAqIENvcHlyaWdodCAoYykgMjAxNy0yMDE4IERpZ2l0YWwgQmF6YWFyLCBJbmMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKi9cbid1c2Ugc3RyaWN0JztcblxuaW1wb3J0IHtDcmVkZW50aWFsSGFuZGxlclJlZ2lzdHJhdGlvbn1cbiAgZnJvbSAnLi9DcmVkZW50aWFsSGFuZGxlclJlZ2lzdHJhdGlvbi5qcyc7XG5cbmV4cG9ydCBjbGFzcyBDcmVkZW50aWFsSGFuZGxlcnMge1xuICBjb25zdHJ1Y3RvcihpbmplY3Rvcikge1xuICAgIHRoaXMuX2luaXQgPSAoYXN5bmMgKCkgPT4ge1xuICAgICAgdGhpcy5faW5qZWN0b3IgPSBhd2FpdCBpbmplY3RvcjtcbiAgICAgIHRoaXMuX3JlbW90ZSA9IHRoaXMuX2luamVjdG9yLmdldCgnY3JlZGVudGlhbEhhbmRsZXJzJywge1xuICAgICAgICBmdW5jdGlvbnM6IFtcbiAgICAgICAgICAncmVnaXN0ZXInLCAndW5yZWdpc3RlcicsICdnZXRSZWdpc3RyYXRpb24nLCAnaGFzUmVnaXN0cmF0aW9uJ11cbiAgICAgIH0pO1xuICAgIH0pKCk7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlcyBhIGNyZWRlbnRpYWwgaGFuZGxlciByZWdpc3RyYXRpb24uXG4gICAqXG4gICAqIEBwYXJhbSB1cmwgdGhlIHVuaXF1ZSBVUkwgZm9yIHRoZSBjcmVkZW50aWFsIGhhbmRsZXIuXG4gICAqXG4gICAqIEByZXR1cm4gYSBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIENyZWRlbnRpYWxIYW5kbGVyUmVnaXN0cmF0aW9uLlxuICAgKi9cbiAgYXN5bmMgcmVnaXN0ZXIodXJsKSB7XG4gICAgYXdhaXQgdGhpcy5faW5pdDtcbiAgICAvLyByZWdpc3RlciB3aXRoIGNyZWRlbnRpYWwgbWVkaWF0b3JcbiAgICB1cmwgPSBhd2FpdCB0aGlzLl9yZW1vdGUucmVnaXN0ZXIoJ2NyZWRlbnRpYWwnLCB1cmwpO1xuICAgIHJldHVybiBuZXcgQ3JlZGVudGlhbEhhbmRsZXJSZWdpc3RyYXRpb24odXJsLCB0aGlzLl9pbmplY3Rvcik7XG4gIH1cblxuICAvKipcbiAgICogVW5yZWdpc3RlcnMgYSBjcmVkZW50aWFsIGhhbmRsZXIsIGRlc3Ryb3lpbmcgaXRzIHJlZ2lzdHJhdGlvbi5cbiAgICpcbiAgICogQHBhcmFtIHVybCB0aGUgdW5pcXVlIFVSTCBmb3IgdGhlIGNyZWRlbnRpYWwgaGFuZGxlci5cbiAgICpcbiAgICogQHJldHVybiBhIFByb21pc2UgdGhhdCByZXNvbHZlcyB0byBgdHJ1ZWAgaWYgdGhlIGhhbmRsZXIgd2FzIHJlZ2lzdGVyZWRcbiAgICogICAgICAgICAgIGFuZCBgZmFsc2VgIGlmIG5vdC5cbiAgICovXG4gIGFzeW5jIHVucmVnaXN0ZXIodXJsKSB7XG4gICAgYXdhaXQgdGhpcy5faW5pdDtcbiAgICAvLyB1bnJlZ2lzdGVyIHdpdGggY3JlZGVudGlhbCBtZWRpYXRvclxuICAgIHJldHVybiB0aGlzLl9yZW1vdGUudW5yZWdpc3RlcignY3JlZGVudGlhbCcsIHVybCk7XG4gIH1cblxuICAvKipcbiAgICogR2V0cyBhbiBleGlzdGluZyBjcmVkZW50aWFsIGhhbmRsZXIgcmVnaXN0cmF0aW9uLlxuICAgKlxuICAgKiBAcGFyYW0gdXJsIHRoZSBVUkwgZm9yIHRoZSBjcmVkZW50aWFsIGhhbmRsZXIuXG4gICAqXG4gICAqIEByZXR1cm4gYSBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gdGhlIENyZWRlbnRpYWxIYW5kbGVyUmVnaXN0cmF0aW9uIG9yXG4gICAqICAgICAgICAgICBgbnVsbGAgaWYgbm8gc3VjaCByZWdpc3RyYXRpb24gZXhpc3RzLlxuICAgKi9cbiAgYXN5bmMgZ2V0UmVnaXN0cmF0aW9uKHVybCkge1xuICAgIGF3YWl0IHRoaXMuX2luaXQ7XG4gICAgdXJsID0gYXdhaXQgdGhpcy5fcmVtb3RlLmdldFJlZ2lzdHJhdGlvbignY3JlZGVudGlhbCcsIHVybCk7XG4gICAgaWYoIXVybCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHJldHVybiBuZXcgQ3JlZGVudGlhbEhhbmRsZXJSZWdpc3RyYXRpb24odXJsLCB0aGlzLl9pbmplY3Rvcik7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0cnVlIGlmIHRoZSBnaXZlbiBjcmVkZW50aWFsIGhhbmRsZXIgaGFzIGJlZW4gcmVnaXN0ZXJlZCBhbmRcbiAgICogZmFsc2UgaWYgbm90LlxuICAgKlxuICAgKiBAcGFyYW0gdXJsIHRoZSBVUkwgZm9yIHRoZSBjcmVkZW50aWFsIGhhbmRsZXIuXG4gICAqXG4gICAqIEByZXR1cm4gYSBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gYHRydWVgIGlmIHRoZSByZWdpc3RyYXRpb24gZXhpc3RzIGFuZFxuICAgKiAgICAgICAgICAgYGZhbHNlYCBpZiBub3QuXG4gICAqL1xuICBhc3luYyBoYXNSZWdpc3RyYXRpb24odXJsKSB7XG4gICAgYXdhaXQgdGhpcy5faW5pdDtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5fcmVtb3RlLmhhc1JlZ2lzdHJhdGlvbignY3JlZGVudGlhbCcsIHVybCk7XG4gIH1cbn1cbiIsIi8qIVxuICogQSBXZWJDcmVkZW50aWFsIGlzIGEgQ3JlZGVudGlhbCB0aGF0IGNhbiBiZSByZXRyaWV2ZWQgZnJvbSBvciBzdG9yZWQgYnkgYVxuICogXCJjcmVkZW50aWFsIGhhbmRsZXJcIiB0aGF0IHJ1bnMgaW4gYSB0aGlyZCBwYXJ0eSBXZWIgYXBwbGljYXRpb24uXG4gKlxuICogQ29weXJpZ2h0IChjKSAyMDE3LTIwMjEgRGlnaXRhbCBCYXphYXIsIEluYy4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqL1xuZXhwb3J0IGNsYXNzIFdlYkNyZWRlbnRpYWwge1xuICBjb25zdHJ1Y3RvcihkYXRhVHlwZSwgZGF0YSwge3JlY29tbWVuZGVkSGFuZGxlck9yaWdpbnMgPSBbXX0gPSB7fSkge1xuICAgIGlmKHR5cGVvZiBkYXRhVHlwZSAhPT0gJ3N0cmluZycpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1wiZGF0YVR5cGVcIiBtdXN0IGJlIGEgc3RyaW5nLicpO1xuICAgIH1cbiAgICB0aGlzLnR5cGUgPSAnd2ViJztcbiAgICB0aGlzLmRhdGFUeXBlID0gZGF0YVR5cGU7XG4gICAgdGhpcy5kYXRhID0gZGF0YTtcbiAgICB0aGlzLm9wdGlvbnMgPSB7cmVjb21tZW5kZWRIYW5kbGVyT3JpZ2luc307XG4gIH1cbn1cbiIsIi8qIVxuICogV3JhcHBlciBmb3IgbmF0aXZlIENyZWRlbnRpYWxzQ29udGFpbmVyIHRoYXQgdXNlcyByZW1vdGUgQ3JlZGVudGlhbCBNZWRpYXRvclxuICogZm9yIFdlYkNyZWRlbnRpYWwtcmVsYXRlZCBvcGVyYXRpb25zLlxuICpcbiAqIENvcHlyaWdodCAoYykgMjAxNy0yMDE4IERpZ2l0YWwgQmF6YWFyLCBJbmMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKi9cbi8qIGdsb2JhbCBuYXZpZ2F0b3IsIERPTUV4Y2VwdGlvbiAqL1xuJ3VzZSBzdHJpY3QnO1xuXG5pbXBvcnQge1dlYkNyZWRlbnRpYWx9IGZyb20gJy4vV2ViQ3JlZGVudGlhbC5qcyc7XG5cbi8vIFJQQyB0aW1lb3V0cywgMCA9IGluZGVmaW5pdGVcbmNvbnN0IENSRURFTlRJQUxfR0VUX1RJTUVPVVQgPSAwO1xuY29uc3QgQ1JFREVOVElBTF9TVE9SRV9USU1FT1VUID0gMDtcblxuZXhwb3J0IGNsYXNzIENyZWRlbnRpYWxzQ29udGFpbmVyIHtcbiAgY29uc3RydWN0b3IoaW5qZWN0b3IpIHtcbiAgICB0aGlzLl9uYXRpdmVDcmVkZW50aWFsc0NvbnRhaW5lciA9IHtcbiAgICAgIGdldDogbmF2aWdhdG9yLmNyZWRlbnRpYWxzICYmIG5hdmlnYXRvci5jcmVkZW50aWFscy5nZXQgJiZcbiAgICAgICAgbmF2aWdhdG9yLmNyZWRlbnRpYWxzLmdldC5iaW5kKG5hdmlnYXRvci5jcmVkZW50aWFscyksXG4gICAgICBzdG9yZTogbmF2aWdhdG9yLmNyZWRlbnRpYWxzICYmIG5hdmlnYXRvci5jcmVkZW50aWFscy5zdG9yZSAmJlxuICAgICAgICBuYXZpZ2F0b3IuY3JlZGVudGlhbHMuc3RvcmUuYmluZChuYXZpZ2F0b3IuY3JlZGVudGlhbHMpLFxuICAgIH07XG5cbiAgICB0aGlzLl9pbml0ID0gKGFzeW5jICgpID0+IHtcbiAgICAgIHRoaXMuX3JlbW90ZSA9IChhd2FpdCBpbmplY3RvcikuZ2V0KCdjcmVkZW50aWFsc0NvbnRhaW5lcicsIHtcbiAgICAgICAgZnVuY3Rpb25zOiBbXG4gICAgICAgICAge25hbWU6ICdnZXQnLCBvcHRpb25zOiB7dGltZW91dDogQ1JFREVOVElBTF9HRVRfVElNRU9VVH19LFxuICAgICAgICAgIHtuYW1lOiAnc3RvcmUnLCBvcHRpb25zOiB7dGltZW91dDogQ1JFREVOVElBTF9TVE9SRV9USU1FT1VUfX1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgfSkoKTtcbiAgfVxuXG4gIGFzeW5jIGdldCgvKkNyZWRlbnRpYWxSZXF1ZXN0T3B0aW9ucyovIG9wdGlvbnMgPSB7fSkge1xuICAgIGlmKG9wdGlvbnMud2ViKSB7XG4gICAgICBhd2FpdCB0aGlzLl9pbml0O1xuICAgICAgY29uc3QgY3JlZGVudGlhbCA9IGF3YWl0IHRoaXMuX3JlbW90ZS5nZXQob3B0aW9ucyk7XG4gICAgICBpZighY3JlZGVudGlhbCkge1xuICAgICAgICAvLyBubyBjcmVkZW50aWFsIHNlbGVjdGVkXG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgLy8gVE9ETzogdmFsaWRhdGUgY3JlZGVudGlhbFxuICAgICAgcmV0dXJuIG5ldyBXZWJDcmVkZW50aWFsKGNyZWRlbnRpYWwuZGF0YVR5cGUsIGNyZWRlbnRpYWwuZGF0YSk7XG4gICAgfVxuICAgIGlmKHRoaXMuX25hdGl2ZUNyZWRlbnRpYWxzQ29udGFpbmVyLmdldCkge1xuICAgICAgcmV0dXJuIHRoaXMuX25hdGl2ZUNyZWRlbnRpYWxzQ29udGFpbmVyLmdldChvcHRpb25zKTtcbiAgICB9XG4gICAgdGhyb3cgbmV3IERPTUV4Y2VwdGlvbignTm90IGltcGxlbWVudGVkLicsICdOb3RTdXBwb3J0ZWRFcnJvcicpO1xuICB9XG5cbiAgYXN5bmMgc3RvcmUoY3JlZGVudGlhbCkge1xuICAgIGlmKGNyZWRlbnRpYWwgaW5zdGFuY2VvZiBXZWJDcmVkZW50aWFsKSB7XG4gICAgICBhd2FpdCB0aGlzLl9pbml0O1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5fcmVtb3RlLnN0b3JlKGNyZWRlbnRpYWwpO1xuICAgICAgaWYoIXJlc3VsdCkge1xuICAgICAgICAvLyBub3RoaW5nIHN0b3JlZFxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIC8vIFRPRE86IHZhbGlkYXRlIHJlc3VsdFxuICAgICAgcmV0dXJuIG5ldyBXZWJDcmVkZW50aWFsKHJlc3VsdC5kYXRhVHlwZSwgcmVzdWx0LmRhdGEpO1xuICAgIH1cbiAgICBpZih0aGlzLl9uYXRpdmVDcmVkZW50aWFsc0NvbnRhaW5lci5zdG9yZSkge1xuICAgICAgcmV0dXJuIHRoaXMuX25hdGl2ZUNyZWRlbnRpYWxzQ29udGFpbmVyLnN0b3JlKGNyZWRlbnRpYWwpO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgRE9NRXhjZXB0aW9uKCdOb3QgaW1wbGVtZW50ZWQuJywgJ05vdFN1cHBvcnRlZEVycm9yJyk7XG4gIH1cbn1cbiIsIi8qIVxuICogUHJvdmlkZXMgYW4gQVBJIGZvciB3b3JraW5nIHdpdGggcGVybWlzc2lvbnMuXG4gKlxuICogQ29weXJpZ2h0IChjKSAyMDE3LTIwMTggRGlnaXRhbCBCYXphYXIsIEluYy4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqL1xuJ3VzZSBzdHJpY3QnO1xuXG4vLyBSUEMgdGltZW91dHMsIDAgPSBpbmRlZmluaXRlXG5jb25zdCBQRVJNSVNTSU9OX1JFUVVFU1RfVElNRU9VVCA9IDA7XG5cbmV4cG9ydCBjbGFzcyBQZXJtaXNzaW9uTWFuYWdlciB7XG4gIGNvbnN0cnVjdG9yKGluamVjdG9yKSB7XG4gICAgdGhpcy5faW5pdCA9IChhc3luYyAoKSA9PiB7XG4gICAgICB0aGlzLl9yZW1vdGUgPSAoYXdhaXQgaW5qZWN0b3IpLmdldCgncGVybWlzc2lvbk1hbmFnZXInLCB7XG4gICAgICAgIGZ1bmN0aW9uczogW1xuICAgICAgICAgICdxdWVyeScsXG4gICAgICAgICAge25hbWU6ICdyZXF1ZXN0Jywgb3B0aW9uczoge3RpbWVvdXQ6IFBFUk1JU1NJT05fUkVRVUVTVF9USU1FT1VUfX0sXG4gICAgICAgICAgJ3Jldm9rZSddXG4gICAgICB9KTtcbiAgICB9KSgpO1xuICB9XG5cbiAgYXN5bmMgcXVlcnkocGVybWlzc2lvbkRlc2MpIHtcbiAgICBhd2FpdCB0aGlzLl9pbml0O1xuICAgIHJldHVybiBhd2FpdCB0aGlzLl9yZW1vdGUucXVlcnkocGVybWlzc2lvbkRlc2MpO1xuICB9XG5cbiAgYXN5bmMgcmVxdWVzdChwZXJtaXNzaW9uRGVzYykge1xuICAgIGF3YWl0IHRoaXMuX2luaXQ7XG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuX3JlbW90ZS5yZXF1ZXN0KHBlcm1pc3Npb25EZXNjKTtcbiAgfVxuXG4gIGFzeW5jIHJldm9rZShwZXJtaXNzaW9uRGVzYykge1xuICAgIGF3YWl0IHRoaXMuX2luaXQ7XG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuX3JlbW90ZS5yZXZva2UocGVybWlzc2lvbkRlc2MpO1xuICB9XG59XG4iLCIvKiFcbiAqIENyZWRlbnRpYWwgSGFuZGxlciBBUEkgUG9seWZpbGwuXG4gKlxuICogQ29weXJpZ2h0IChjKSAyMDE3LTIwMjEgRGlnaXRhbCBCYXphYXIsIEluYy4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqL1xuLyogZ2xvYmFsIG5hdmlnYXRvciwgd2luZG93ICovXG4ndXNlIHN0cmljdCc7XG5cbmltcG9ydCAqIGFzIHJwYyBmcm9tICd3ZWItcmVxdWVzdC1ycGMnO1xuXG5pbXBvcnQge0NyZWRlbnRpYWxIYW5kbGVyfSBmcm9tICcuL0NyZWRlbnRpYWxIYW5kbGVyLmpzJztcbmltcG9ydCB7Q3JlZGVudGlhbEhhbmRsZXJzfSBmcm9tICcuL0NyZWRlbnRpYWxIYW5kbGVycy5qcyc7XG5pbXBvcnQge0NyZWRlbnRpYWxNYW5hZ2VyfSBmcm9tICcuL0NyZWRlbnRpYWxNYW5hZ2VyLmpzJztcbmltcG9ydCB7Q3JlZGVudGlhbHNDb250YWluZXJ9IGZyb20gJy4vQ3JlZGVudGlhbHNDb250YWluZXIuanMnO1xuaW1wb3J0IHtQZXJtaXNzaW9uTWFuYWdlcn0gZnJvbSAnLi9QZXJtaXNzaW9uTWFuYWdlci5qcyc7XG5pbXBvcnQge1dlYkNyZWRlbnRpYWx9IGZyb20gJy4vV2ViQ3JlZGVudGlhbC5qcyc7XG5cbmNvbnN0IERFRkFVTFRfTUVESUFUT1IgPSAnaHR0cHM6Ly9hdXRobi5pby9tZWRpYXRvcicgKyAnP29yaWdpbj0nICtcbiAgZW5jb2RlVVJJQ29tcG9uZW50KHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4pO1xuXG4vLyBleHBvcnQgY2xhc3NlcyBmb3IgdGVzdGluZy9UeXBlU2NyaXB0XG5leHBvcnQge1xuICBDcmVkZW50aWFsSGFuZGxlcixcbiAgQ3JlZGVudGlhbE1hbmFnZXIsXG4gIFdlYkNyZWRlbnRpYWxcbn07XG5cbmxldCBsb2FkZWQ7XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9hZE9uY2UobWVkaWF0b3JVcmwgPSBERUZBVUxUX01FRElBVE9SKSB7XG4gIGlmKGxvYWRlZCkge1xuICAgIHJldHVybiBsb2FkZWQ7XG4gIH1cblxuICBsb2FkZWQgPSB0cnVlO1xuICByZXR1cm4gbG9hZChtZWRpYXRvclVybCk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2FkKG1lZGlhdG9yVXJsID0gREVGQVVMVF9NRURJQVRPUikge1xuICBjb25zdCBhcHBDb250ZXh0ID0gbmV3IHJwYy5XZWJBcHBDb250ZXh0KCk7XG4gIGNvbnN0IGluamVjdG9yID0gYXBwQ29udGV4dC5jcmVhdGVXaW5kb3cobWVkaWF0b3JVcmwsIHtcbiAgICBjbGFzc05hbWU6ICdjcmVkZW50aWFsLW1lZGlhdG9yJyxcbiAgICAvLyAzMCBzZWNvbmQgdGltZW91dCBmb3IgbG9hZGluZyB0aGUgbWVkaWF0b3JcbiAgICB0aW1lb3V0OiAzMDAwMFxuICB9KTtcbiAgLy8gZW5zdXJlIGJhY2tkcm9wIGlzIHRyYW5zcGFyZW50IGJ5IGRlZmF1bHRcbiAgY29uc3Qgc3R5bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHlsZScpO1xuICBzdHlsZS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShcbiAgICBgZGlhbG9nLndlYi1hcHAtd2luZG93LmNyZWRlbnRpYWwtbWVkaWF0b3IgPiAud2ViLWFwcC13aW5kb3ctYmFja2Ryb3Age1xuICAgICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAwLCAwLCAwLjI1KTtcbiAgICB9YCkpO1xuICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHN0eWxlKTtcblxuICBjb25zdCBwb2x5ZmlsbCA9IHt9O1xuXG4gIC8vIFRPRE86IG9ubHkgZXhwb3NlIGNlcnRhaW4gQVBJcyB3aGVuIGFwcHJvcHJpYXRlXG4gIHBvbHlmaWxsLnBlcm1pc3Npb25zID0gbmV3IFBlcm1pc3Npb25NYW5hZ2VyKGluamVjdG9yKTtcbiAgcG9seWZpbGwuQ3JlZGVudGlhbEhhbmRsZXJzID0gbmV3IENyZWRlbnRpYWxIYW5kbGVycyhpbmplY3Rvcik7XG4gIHBvbHlmaWxsLkNyZWRlbnRpYWxIYW5kbGVyID0gQ3JlZGVudGlhbEhhbmRsZXI7XG4gIHBvbHlmaWxsLkNyZWRlbnRpYWxNYW5hZ2VyID0gQ3JlZGVudGlhbE1hbmFnZXI7XG4gIHBvbHlmaWxsLmNyZWRlbnRpYWxzID0gbmV3IENyZWRlbnRpYWxzQ29udGFpbmVyKGluamVjdG9yKTtcbiAgcG9seWZpbGwuV2ViQ3JlZGVudGlhbCA9IFdlYkNyZWRlbnRpYWw7XG5cbiAgLy8gZXhwb3NlIHBvbHlmaWxsXG4gIG5hdmlnYXRvci5jcmVkZW50aWFsc1BvbHlmaWxsID0gcG9seWZpbGw7XG5cbiAgLy8gcG9seWZpbGxcbiAgaWYoJ2NyZWRlbnRpYWxzJyBpbiBuYXZpZ2F0b3IpIHtcbiAgICBuYXZpZ2F0b3IuY3JlZGVudGlhbHMuZ2V0ID0gcG9seWZpbGwuY3JlZGVudGlhbHMuZ2V0LmJpbmQoXG4gICAgICBwb2x5ZmlsbC5jcmVkZW50aWFscyk7XG4gICAgbmF2aWdhdG9yLmNyZWRlbnRpYWxzLnN0b3JlID0gcG9seWZpbGwuY3JlZGVudGlhbHMuc3RvcmUuYmluZChcbiAgICAgIHBvbHlmaWxsLmNyZWRlbnRpYWxzKTtcbiAgfSBlbHNlIHtcbiAgICBuYXZpZ2F0b3IuY3JlZGVudGlhbHMgPSBwb2x5ZmlsbC5jcmVkZW50aWFscztcbiAgfVxuICB3aW5kb3cuQ3JlZGVudGlhbE1hbmFnZXIgPSBDcmVkZW50aWFsTWFuYWdlcjtcbiAgd2luZG93LldlYkNyZWRlbnRpYWwgPSBXZWJDcmVkZW50aWFsO1xuXG4gIHJldHVybiBwb2x5ZmlsbDtcbn1cbiIsImltcG9ydCBCdXR0b24gZnJvbSAnQG1hdGVyaWFsLXVpL2NvcmUvQnV0dG9uJ1xuaW1wb3J0IElucHV0QWRvcm5tZW50IGZyb20gJ0BtYXRlcmlhbC11aS9jb3JlL0lucHV0QWRvcm5tZW50J1xuaW1wb3J0IFRleHRGaWVsZCBmcm9tICdAbWF0ZXJpYWwtdWkvY29yZS9UZXh0RmllbGQnXG5pbXBvcnQgVHlwb2dyYXBoeSBmcm9tICdAbWF0ZXJpYWwtdWkvY29yZS9UeXBvZ3JhcGh5J1xuaW1wb3J0IHsgR3JpZCB9IGZyb20gJ0BtYXRlcmlhbC11aS9jb3JlJ1xuaW1wb3J0IFJlYWN0LCB7IHVzZUVmZmVjdCwgdXNlU3RhdGUgfSBmcm9tICdyZWFjdCdcbmltcG9ydCB7IGNvbm5lY3QsIHVzZURpc3BhdGNoIH0gZnJvbSAncmVhY3QtcmVkdXgnXG5pbXBvcnQgeyBDb25maWcsIHZhbGlkYXRlRW1haWwsIHZhbGlkYXRlUGhvbmVOdW1iZXIgfSBmcm9tICdAeHJlbmdpbmUvY29tbW9uL3NyYy9jb25maWcnXG5pbXBvcnQgKiBhcyBwb2x5ZmlsbCBmcm9tICdjcmVkZW50aWFsLWhhbmRsZXItcG9seWZpbGwnXG5pbXBvcnQgc3R5bGVzIGZyb20gJy4vQWRtaW5Mb2dpbi5tb2R1bGUuc2NzcydcbmltcG9ydCB7IHVzZVRyYW5zbGF0aW9uIH0gZnJvbSAncmVhY3QtaTE4bmV4dCdcbmltcG9ydCB7IHVzZUF1dGhTdGF0ZSB9IGZyb20gJ0B4cmVuZ2luZS9jbGllbnQtY29yZS9zcmMvdXNlci9yZWR1Y2Vycy9hdXRoL0F1dGhTdGF0ZSdcbmltcG9ydCB7IEF1dGhTZXJ2aWNlIH0gZnJvbSAnQHhyZW5naW5lL2NsaWVudC1jb3JlL3NyYy91c2VyL3JlZHVjZXJzL2F1dGgvQXV0aFNlcnZpY2UnXG5cbmludGVyZmFjZSBQcm9wcyB7XG4gIGNoYW5nZUFjdGl2ZU1lbnU/OiBhbnlcbiAgc2V0UHJvZmlsZU1lbnVPcGVuPzogYW55XG4gIGNsYXNzZXM/OiBhbnlcblxuICBoaWRlTG9naW4/OiBhbnlcbn1cblxuY29uc3QgQWRtaW5Mb2dpbiA9IChwcm9wczogUHJvcHMpOiBhbnkgPT4ge1xuICBjb25zdCB7IGNoYW5nZUFjdGl2ZU1lbnUsIHNldFByb2ZpbGVNZW51T3BlbiwgaGlkZUxvZ2luIH0gPSBwcm9wc1xuICBjb25zdCB7IHQgfSA9IHVzZVRyYW5zbGF0aW9uKClcblxuICBjb25zdCBkaXNwYXRjaCA9IHVzZURpc3BhdGNoKClcbiAgY29uc3Qgc2VsZlVzZXIgPSB1c2VBdXRoU3RhdGUoKS51c2VyXG5cbiAgY29uc3QgW3VzZXJuYW1lLCBzZXRVc2VybmFtZV0gPSB1c2VTdGF0ZShzZWxmVXNlcj8ubmFtZS52YWx1ZSlcbiAgY29uc3QgW2VtYWlsUGhvbmUsIHNldEVtYWlsUGhvbmVdID0gdXNlU3RhdGUoJycpXG4gIGNvbnN0IFtlcnJvciwgc2V0RXJyb3JdID0gdXNlU3RhdGUoZmFsc2UpXG4gIGNvbnN0IFtlcnJvclVzZXJuYW1lLCBzZXRFcnJvclVzZXJuYW1lXSA9IHVzZVN0YXRlKGZhbHNlKVxuICBjb25zdCB7IGNsYXNzZXMgfSA9IHByb3BzXG5cbiAgbGV0IHR5cGUgPSAnJ1xuXG4gIGNvbnN0IGxvYWRDcmVkZW50aWFsSGFuZGxlciA9IGFzeW5jICgpID0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgbWVkaWF0b3IgPSBgJHtDb25maWcucHVibGljUnVudGltZUNvbmZpZy5tZWRpYXRvclNlcnZlcn0vbWVkaWF0b3I/b3JpZ2luPSR7ZW5jb2RlVVJJQ29tcG9uZW50KFxuICAgICAgICB3aW5kb3cubG9jYXRpb24ub3JpZ2luXG4gICAgICApfWBcblxuICAgICAgYXdhaXQgcG9seWZpbGwubG9hZE9uY2UobWVkaWF0b3IpXG4gICAgICBjb25zb2xlLmxvZygnUmVhZHkgdG8gd29yayB3aXRoIGNyZWRlbnRpYWxzIScpXG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgbG9hZGluZyBwb2x5ZmlsbDonLCBlKVxuICAgIH1cbiAgfVxuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgbG9hZENyZWRlbnRpYWxIYW5kbGVyKClcbiAgfSwgW10pIC8vIE9ubHkgcnVuIG9uY2VcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIHNlbGZVc2VyICYmIHNldFVzZXJuYW1lKHNlbGZVc2VyLm5hbWUudmFsdWUpXG4gIH0sIFtzZWxmVXNlci5uYW1lLnZhbHVlXSlcblxuICBjb25zdCBoYW5kbGVJbnB1dENoYW5nZSA9IChlKSA9PiBzZXRFbWFpbFBob25lKGUudGFyZ2V0LnZhbHVlKVxuXG4gIGNvbnN0IHZhbGlkYXRlID0gKCkgPT4ge1xuICAgIGlmIChlbWFpbFBob25lID09PSAnJykgcmV0dXJuIGZhbHNlXG4gICAgaWYgKHZhbGlkYXRlRW1haWwoZW1haWxQaG9uZS50cmltKCkpKSB0eXBlID0gJ2VtYWlsJ1xuICAgIGVsc2UgaWYgKHZhbGlkYXRlUGhvbmVOdW1iZXIoZW1haWxQaG9uZS50cmltKCkpKSB0eXBlID0gJ3NtcydcbiAgICBlbHNlIHtcbiAgICAgIHNldEVycm9yKHRydWUpXG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG5cbiAgICBzZXRFcnJvcihmYWxzZSlcbiAgICByZXR1cm4gdHJ1ZVxuICB9XG5cbiAgY29uc3QgaGFuZGxlU3VibWl0ID0gKGU6IGFueSk6IGFueSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpXG4gICAgaWYgKCF2YWxpZGF0ZSgpKSByZXR1cm5cbiAgICBpZiAodHlwZSA9PT0gJ2VtYWlsJykgZGlzcGF0Y2goQXV0aFNlcnZpY2UuYWRkQ29ubmVjdGlvbkJ5RW1haWwoZW1haWxQaG9uZSwgc2VsZlVzZXI/LmlkPy52YWx1ZSkpXG4gICAgZWxzZSBpZiAodHlwZSA9PT0gJ3NtcycpIGRpc3BhdGNoKEF1dGhTZXJ2aWNlLmFkZENvbm5lY3Rpb25CeVNtcyhlbWFpbFBob25lLCBzZWxmVXNlcj8uaWQ/LnZhbHVlKSlcbiAgICByZXR1cm5cbiAgfVxuXG4gIHJldHVybiAoXG4gICAgPGRpdiBjbGFzc05hbWU9e3N0eWxlcy5jb250YWluZXJ9PlxuICAgICAgPEdyaWQgY29udGFpbmVyIGNsYXNzTmFtZT17c3R5bGVzLmdyaWRDb250YWluZXJ9PlxuICAgICAgICA8R3JpZCBpdGVtPlxuICAgICAgICAgIDxmb3JtIG9uU3VibWl0PXtoYW5kbGVTdWJtaXR9IHN0eWxlPXt7IGRpc3BsYXk6ICdncmlkJyB9fT5cbiAgICAgICAgICAgIDxUZXh0RmllbGRcbiAgICAgICAgICAgICAgY2xhc3NOYW1lPXtzdHlsZXMuZW1haWxGaWVsZH1cbiAgICAgICAgICAgICAgc2l6ZT1cInNtYWxsXCJcbiAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJFbWFpbFwiXG4gICAgICAgICAgICAgIHZhcmlhbnQ9XCJvdXRsaW5lZFwiXG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXtoYW5kbGVJbnB1dENoYW5nZX1cbiAgICAgICAgICAgICAgb25CbHVyPXt2YWxpZGF0ZX1cbiAgICAgICAgICAgICAgZXJyb3I9e2Vycm9yfVxuICAgICAgICAgICAgICBoZWxwZXJUZXh0PXtlcnJvciA/IHQoJ3VzZXI6dXNlcm1lbnUucHJvZmlsZS5waG9uZUVtYWlsRXJyb3InKSA6IG51bGx9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICAgPEJ1dHRvbiBjbGFzc05hbWU9e3N0eWxlcy5zZW5kQnV0dG9ufSBvbkNsaWNrPXtoYW5kbGVTdWJtaXR9PlxuICAgICAgICAgICAgICBTZW5kIE1hZ2ljIExpbmtcbiAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgIDwvZm9ybT5cbiAgICAgICAgPC9HcmlkPlxuICAgICAgPC9HcmlkPlxuICAgIDwvZGl2PlxuICApXG59XG5cbmV4cG9ydCBkZWZhdWx0IEFkbWluTG9naW5cbiIsImltcG9ydCB7IEVtcHR5TGF5b3V0IH0gZnJvbSAnQHhyZW5naW5lL2NsaWVudC1jb3JlL3NyYy9jb21tb24vY29tcG9uZW50cy9MYXlvdXQvRW1wdHlMYXlvdXQnXG5pbXBvcnQgeyBBdXRoU2VydmljZSB9IGZyb20gJ0B4cmVuZ2luZS9jbGllbnQtY29yZS9zcmMvdXNlci9yZWR1Y2Vycy9hdXRoL0F1dGhTZXJ2aWNlJ1xuaW1wb3J0IFJlYWN0LCB7IHVzZUVmZmVjdCB9IGZyb20gJ3JlYWN0J1xuaW1wb3J0IHsgY29ubmVjdCwgdXNlRGlzcGF0Y2ggfSBmcm9tICdyZWFjdC1yZWR1eCdcbmltcG9ydCB7IGJpbmRBY3Rpb25DcmVhdG9ycywgRGlzcGF0Y2ggfSBmcm9tICdyZWR1eCdcbmltcG9ydCB7IHVzZVRyYW5zbGF0aW9uIH0gZnJvbSAncmVhY3QtaTE4bmV4dCdcbmltcG9ydCBBZG1pbkxvZ2luIGZyb20gJy4uL2NvbXBvbmVudHMvQWRtaW5Mb2dpbidcblxuaW50ZXJmYWNlIFByb3BzIHt9XG5cbmV4cG9ydCBjb25zdCBJbmRleFBhZ2UgPSAocHJvcHM6IFByb3BzKTogYW55ID0+IHtcbiAgLy9jb25zdCB7IGRvTG9naW5BdXRvIH0gPSBwcm9wc1xuICBjb25zdCBkaXNwYXRjaCA9IHVzZURpc3BhdGNoKClcbiAgY29uc3QgeyB0IH0gPSB1c2VUcmFuc2xhdGlvbigpXG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBkaXNwYXRjaChBdXRoU2VydmljZS5kb0xvZ2luQXV0byh0cnVlKSlcbiAgfSwgW10pXG5cbiAgLy8gPEJ1dHRvbiBjbGFzc05hbWU9XCJyaWdodC1ib3R0b21cIiB2YXJpYW50PVwiY29udGFpbmVkXCIgY29sb3I9XCJzZWNvbmRhcnlcIiBhcmlhLWxhYmVsPVwic2NlbmVcIiBvbkNsaWNrPXsoZSkgPT4geyBzZXRTY2VuZVZpc2libGUoIXNjZW5lSXNWaXNpYmxlKTsgZS5jdXJyZW50VGFyZ2V0LmJsdXIoKTsgfX0+c2NlbmU8L0J1dHRvbj5cblxuICByZXR1cm4gKFxuICAgIDxFbXB0eUxheW91dCBwYWdlVGl0bGU9e3QoJ2xvZ2luLnBhZ2VUaXRsZScpfT5cbiAgICAgIHsvKiA8c3R5bGU+XG4gICAgICAgIHsnICd9XG4gICAgICAgIHtgXG4gICAgICAgICAgICAgICAgW2NsYXNzKj1tZW51UGFuZWxdIHtcbiAgICAgICAgICAgICAgICAgICAgdG9wOiA3NXB4O1xuICAgICAgICAgICAgICAgICAgICBib3R0b206IGluaXRpYWw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgYH1cbiAgICAgIDwvc3R5bGU+ICovfVxuICAgICAgPEFkbWluTG9naW4gLz5cbiAgICA8L0VtcHR5TGF5b3V0PlxuICApXG59XG5cbmV4cG9ydCBkZWZhdWx0IEluZGV4UGFnZVxuIl0sIm5hbWVzIjpbInV0aWxzLnBhcnNlVXJsIiwidXRpbHMuY3JlYXRlTWVzc2FnZUxpc3RlbmVyIiwidXRpbHMuZGVzZXJpYWxpemVFcnJvciIsInV0aWxzLnV1aWR2NCIsInV0aWxzLmlzSGFuZGxlUHJvbWlzZSIsInV0aWxzLmRlc3RydWN0dXJlTWV0aG9kTmFtZSIsInV0aWxzLnNlcmlhbGl6ZUVycm9yIiwidXRpbHMuUlBDX0VSUk9SUyIsInJwYy5XZWJBcHBXaW5kb3ciLCJycGMuV2ViQXBwIiwicnBjLkV2ZW50RW1pdHRlciIsInJwYy5XZWJBcHBDb250ZXh0IiwidXNlU3RhdGUiLCJwb2x5ZmlsbC5sb2FkT25jZSJdLCJtYXBwaW5ncyI6IjR3QkFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEdBUU8sS0FBTSxHQUFhLENBQ3hCLFdBQVksQ0FDVixRQUFTLGNBQ1QsS0FBTSxRQUVSLGVBQWdCLENBQ2QsUUFBUyxrQkFDVCxLQUFNLFFBRVIsZUFBZ0IsQ0FDZCxRQUFTLG1CQUNULEtBQU0sUUFFUixjQUFlLENBQ2IsUUFBUyxpQkFDVCxLQUFNLFFBRVIsY0FBZSxDQUNiLFFBQVMsaUJBQ1QsS0FBTSxRQUVSLFlBQWEsQ0FDWCxRQUFTLGVBQ1QsS0FBTSxRQUlILFdBQWtCLEVBQUssRUFBTSxDQUtsQyxHQUpHLElBQVMsUUFDVixHQUFPLE9BQU8sU0FBUyxNQUd0QixNQUFPLE1BQVEsV0FDaEIsTUFBTyxJQUFJLEtBQUksRUFBSyxHQUd0QixHQUFHLE1BQU8sSUFBUSxTQUNoQixLQUFNLElBQUksV0FBVSwyQkFJdEIsQUFBSSxFQUFJLFNBQVMsTUFDZixDQUFHLEVBQUssV0FBVyxTQUFXLENBQUMsRUFBSSxXQUFXLEtBQzVDLEVBQU0sRUFBTyxJQUFNLEVBRW5C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
